<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="renderer" content="webkit">
    <title>医疗器械</title>
    <!--Bootstrap样式引入开始-->
    <link rel="stylesheet" href="../resource/css/bootstrap.min.css">
    <link href="../resource/js/plugins/bootstarp-table/css/bootstrap-table.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../resource/js/plugins/bootstrapzTree/bootstrapStyle.css" type="text/css">
    <link rel="stylesheet" href="../resource/js/plugins/bootstrap-select/css/bootstrap-select.min.css" type="text/css">
    <link href="../resource/css/plugins/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css" rel="stylesheet">

    <!--Bootstrap样式引入结束-->
    <!--字体样式文件引用开始-->
    <link rel="stylesheet" href="../resource/fonts/iconfont.css">
    <!--字体样式文件引用结束-->
    <!--标签样式重置开始-->
    <link rel="stylesheet" href="../resource/css/reset.css">
    <link rel="stylesheet" href="../resource/css/style.css">
    <!--标签样式重置结束-->
    <!--公用组件样式-->
    <link rel="stylesheet" href="../resource/css/common.css">
    <link href="../resource/layui/css/layui.css" rel="stylesheet">
    <!--公用组件样式结束-->
    <!--单页样式-->
    <link rel="stylesheet" href="../resource/css/yanjing/medical.css">
    <!--<link rel="stylesheet" href="../resource/css/yanjing/companyManage.css">-->
    <link rel="stylesheet" href="../resource/css/yanjing/goodsManage.css">
    <link href="../resource/css/yanjing/mobiscroll.2.13.2.css" rel="stylesheet">
    <link href="../resource/css/yanjing/myDate.css" rel="stylesheet">
    <link rel="stylesheet" href="../resource/css/baiduMap.css">
    <script src="../resource/js/baiduMap.js"></script>
</head>

<body class="body-bg">
<div class="header clear">
    <ul class="tab-ul clear tab-ul-header">
        <li class="active">产品列表</li>
        <li>入库记录</li>
        <li>出库记录</li>
    </ul>
    <ol class="clear">
        <li class="right-info active">
            <span class="btn1" onclick="proLists()">企业列表</span>
            <span class="btn2" onclick="employList()">员工列表</span>
            <input type="search" class="search-box" placeholder="搜索生产批号">
            <span class="scSearch" onclick="scSearch()">搜索</span>
            <span class="addbtn" onclick="addGoods(false)">新增商品</span>
        </li>
    </ol>
</div>
<div id="second-bar">
    <div id="select-time-header">
        <div class="yj-demo-time">
            <div class="yj-date">
                <span>开始时间-结束时间</span><i class="iconfont icon-ico_calendar"></i>
            </div>
        </div>
    </div>
</div>
<div class="cpListTop">
    <span class="cpListItems c1 active">产品列表</span>
    <span class="cpListItems c2">商品及库存</span>
</div>
<div class="content1 tab-item active bgcolor">
    <div class="tab-item-li">
        <div class="warn1">
            <div class="daoqiWarn" onclick="warnSP()">
                <span class="warnLeft">
                    <i class="iconfont icon-ico_contact_lens "></i>
                    有 <span class="notBuChongNum"></span> 家企业证件有效期到期
                </span>
                <i class="iconfont icon-ico_arrow_right warnRight"></i>
            </div>
        </div>
        <div id="table1">
            <table id="xsjl-table" data-toggle="table" class="table table-border"></table>
        </div>
        <div id="table2">
            <table id="xsjl-table1" data-toggle="table" class="table table-border"></table>
        </div>
    </div>
    <!--商品及库存-->
    <div class="tab-item-li" style="display: none">
        <div class="warn2">
            <div class="daoqiWarn" onclick="kuCunWarnSP()">
                <span class="warnLeft">
                    <i class="iconfont icon-ico_contact_lens "></i>
                    有 <span class="notKuChongNum"></span> 家企业证件有效期到期
                </span>
                <i class="iconfont icon-ico_arrow_right warnRight"></i>
            </div>
        </div>
        <div id="table3">
            <ul class="tab-head">
                <li class="tab-head-li">
                    <div><input type="checkbox" class="checkbox5"></div>
                    <div>批次</div>
                    <div>库存</div>
                    <div>有效期</div>
                    <div>操作</div>
                </li>
                <li class="tab-head-li2">
                    <div><input type="checkbox" class="checkbox5"></div>
                    <div><span class="brandNames">暴龙眼镜</span><span class="seriesName">A 系列</span></div>
                    <div class="last-head">总库存 <span class="zKuCunNum">20</span><i class="iconfont icon-ico_arrow_down"></i></div>
                    <ul class="tab-head-item" id="card-list1">
                        <li>
                            <div><input type="checkbox" class="checkbox5"></div>
                            <div>PTB39712891902</div>
                            <div>64</div>
                            <div>2019.08.12-2020.10.21</div>
                            <div><span class="daYin">条码打印</span><span class="tui">退货</span><span class="xiao">销毁</span></div>
                        </li>
                        <li>
                            <div><input type="checkbox" class="checkbox5"></div>
                            <div>PTB39712891902</div>
                            <div>64</div>
                            <div>2019.08.12-2020.10.21</div>
                            <div><span class="daYin">条码打印</span><span class="tui">退货</span><span class="xiao">销毁</span></div>
                        </li>
                    </ul>
                </li>
                <table id="yj-page-table" data-toggle="table" class="table table-border"></table>
            </ul>
<!--            <table id="kcdq-table"-->
<!--                   data-toggle="table"-->
<!--                   data-toolbar="#toolbar"-->
<!--                   data-detail-view="true"-->
<!--                   data-detail-filter="detailFilter"-->
<!--                   data-detail-formatter="detailFormatter"-->
<!--                   class="table table-border">-->
<!--            </table>-->
        </div>
        <div id="table4" style="display: none">
            <table id="kcdq-table1"
                   data-toggle="table"
                   data-detail-view="true"
                   data-detail-formatter="detailFormatter"
                   class="table table-border">
            </table>
        </div>
    </div>
</div>
<div class="content2 tab-item">
    <table id="rkjl-table" data-toggle="table" class="table table-border"></table>
</div>
<div class="content3 tab-item">
    <ul class="ckReload clear">
        <li class="active">销售记录</li>
        <li>退货记录</li>
        <li>销毁记录</li>
    </ul>
    <div class="content3_1 tab-items active">
        <table id="xsReload-table" data-toggle="table" class="table table-border"></table>
    </div>
    <div class="content3_2 tab-items" style="display: none;">
        <table id="thReload-table" data-toggle="table" class="table table-border"></table>
    </div>
    <div class="content3_3 tab-items" style="display: none;">
        <table id="xhReload-table" data-toggle="table" class="table table-border"></table>
    </div>
    <div class="content-view"></div>
</div>

<!--商品及库存(退货)弹窗-->
<div id="tuiHuoToast" style="display: none">
    此操作不可撤销
</div>
<!--商品及库存(销毁)弹窗-->
<div id="xiaohuiToast" style="display: none">
    退货单可在商品管理-出库中查看
</div>
<!--员工列表体检/培训记录弹窗-->
<div class="content-view content-view-tjReload" id="ygTjReloadList1">
</div>
<!-- 企业列表 -->
<div class="content-view content-view-proLists">
    <div class="qyHeader">
        <span id="qyList1">所有企业</span>
        <span id="qyList2" onclick="addPros(false)">新增企业</span>
    </div>
    <div class="qiyeLists">
        <div class="daoqiWarn" onclick="cardGuoqi()">
                <span class="warnLeft">
                    <i class="iconfont icon-ico_contact_lens "></i>
                    有 <span class="daoNum"></span> 家企业证件有效期到期
                </span>
            <i class="iconfont icon-ico_arrow_right warnRight"></i>
        </div>
        <table id="qyxx-table" data-toggle="table" class="table table-border"></table>

    </div>
</div>

<!--企业详细弹窗-->
<div class="content-view content-view-shopDes" id="shopDom">

</div>

<!--新增镜片-->
<div class="content-view content-view-addgoods" id="addGoodsDom">

</div>
<!--设置提成的弹出框-->
<div class="content-view content-view-ticheng" id="tiChengDom">

</div>
<!--设置现货范围-->
<div class="content-view content-view-range">
    <div class="yj-content-body">
        <div class="range-header">
            <div class="now-goods-range">
                <em></em>现货范围
            </div>
            <div class="dingzhi-range">
                <em></em>定制范围
            </div>
        </div>
        <table class="layui-hide yj-layui-table" id="rangeEvent" lay-filter="rangeEvent"></table>
    </div>
</div>
<!--设定价格-->
<div class="content-view content-view-price">
    <ul class="tab-ul" id="setPriceBtn">
        <li onclick="setPrice(1)">零售价/元</li>
        <li onclick="setPrice(2)">批发价/元</li>
        <li onclick="setPrice(3)">备货量/片</li>
        <li onclick="setPrice(4)">积分价/分</li>
        <li onclick="setPrice(5)">左眼选择</li>
        <li onclick="setPrice(6)">右眼选择</li>
    </ul>
    <div class="price-table-box">
        <table class="layui-hide yj-layui-table" id="priceEvent" lay-filter="priceEvent"></table>
    </div>
</div>

<!-- 员工列表 -->
<div class="content-view content-view-employList">
    <div class="qyHeader">
        <span id="ygLi1">所有员工</span>
        <span id="ygLi2" onclick="tjReload(id)">培训记录</span>
        <span id="ygLi3" onclick="tjReload(id)">体检记录</span>
    </div>
    <ul class="yuangongUl" id="yuangongList1">
    </ul>
</div>

<!-- 证件有效期到期弹窗 -->
<div class="content-view content-view-cardGuoqi">
    <table id="zjdq-table" data-toggle="table" class="table table-border"></table>
</div>
<!--全局JS引用-->
<form style="opacity: 0" action="" id="uploadForm" autocomplete="off" enctype="multipart/form-data">
    <input style="height: 0;width: 0;" type="file" name="file"
           accept="image/jpeg，image/jpg，image/png,image/jp2，image/jpe" multiple="multiple"/>
</form>
<script src="../resource/js/jquery.min.js"></script>
<script src="../resource/js/bootstrap.js?v=3.3.6"></script>
<script src="../resource/js/plugins/bootstarp-table/js/bootstrap-table.js"></script>
<script src="../resource/js/plugins/bootstarp-table/js/bootstrap-table-zh-CN.min.js"></script>
<script src="../resource/js/plugins/layer/layer.js"></script>
<script src="../resource/layui/layui.js"></script>
<script src="../resource/js/yanjing/mobiscroll.2.13.2.js"></script>
<!--//日期范围插件开始-->
<script src="../resource/js/yanjing/daterange.js"></script>
<!--//日期范围插件结束-->
<script src="../resource/js/lib/quakooLib/QuakooBase-1.0.0.js"></script>
<script src="../resource/js/lib/quakooLib/QuakooConfig-1.0.0.js"></script>
<script src="../resource/js/lib/quakooLib/QuakooBasePc-1.0.0.js"></script>
<script src="../resource/js/lib/quakoo/Config.js"></script>
<script src="../resource/js/lib/quakoo/project.js"></script>
<script src="../resource/common/common.js?" +Math.random()></script>
<script src="../resource/js/template-native.js"></script>
<script src="../resource/js/yanjing/yanjing.js"></script>
<script src="../resource/js/yanjing/mobiscroll.2.13.2.js"></script>
<script src="../resource/js/yanjing/daterange.js"></script>
<script src="../resource/js/area/areaUtils.js"></script>
<script type="text/html" id="shopTmp">
    <div class="shopMsg">
        <ul class="clearfix">
            <li class="clearfix">
                <p class="title">企业名称</p>
                <input type="text" value="<%=list.name%>" id="qysname" placeholder="名称">
            </li>
            <li>
                <p class="title">联系人</p>
                <input type="text" value="<%=list.userName%>" id="lxsname" placeholder="输入">
            </li>
            <li>
                <p class="title">联系电话</p>
                <input type="number" value="<%=list.phone%>" id="lxphone" placeholder="电话">
            </li>
            <li>
                <p class="title">经营范围</p>
                <div id="select1" class="selectBox">
                    <span class="select-box-header">
                        <span class="text">
                            <%if(list.range){%>
                                <%=list.range%>
                            <%}else{%>
                                经营范围
                            <%}%>
                        </span>
                        <i class="iconfont icon-ico_arrow_down"></i>
                    </span>
                    <div class="optionBox">
                        <ul class="optionUL" id="option1">
                        </ul>
                    </div>
                </div>
            </li>
        </ul>
    </div>
    <div class="address">
        <p class="title">详细地址</p>
        <!--<div class="mapDiv" id="mapDiv"></div>-->
        <div class="inputBox">
            <div class="selectBox" id="province">
                <div class="select-box-header">
                    <%if(list.provinceName){%>
                    <span class="text"><%=list.provinceName%></span> <i class="iconfont icon-ico_arrow_down"></i>
                    <%}else{%>
                    <span class="text t1">选择省</span> <i class="iconfont icon-ico_arrow_down t1"></i>
                    <%}%>
                </div>
                <div class="optionBox">
                    <ul class="optionUL">
                        <%for(var i in oneArea){%>
                        <li value="<%=oneArea[i].id%>"><%=oneArea[i].name%></li>
                        <%}%>
                    </ul>
                </div>
            </div>
            <div class="selectBox" id="city">
                <div class="select-box-header">
                    <%if(list.cityName){%>
                    <span class="text"><%=list.cityName%></span> <i
                        class="iconfont icon-ico_arrow_down"></i>
                    <%}else{%>
                    <span class="text t1">选择市</span> <i class="iconfont icon-ico_arrow_down t1"></i>
                    <%}%>
                </div>
                <%if(twoArea.length>0){%>
                <div class="optionBox">
                    <ul class="optionUL">
                        <%for(var i in twoArea){%>
                        <li value="<%=twoArea[i].id%>"><%=twoArea[i].name%></li>
                        <%}%>
                    </ul>
                </div>
                <%}%>
            </div>
            <div class="selectBox" id="area" style="width: 32%">
                <div class="select-box-header">
                    <%if(list.areaName){%>
                    <span class="text"><%=list.areaName%></span>
                    <i class="iconfont icon-ico_arrow_down"></i>
                    <%}else{%>
                    <span class="text t1">选择区/县</span>
                    <i class="iconfont icon-ico_arrow_down t1"></i>
                    <%}%>
                </div>
                <%if(threeArea.length>0){%>
                <div class="optionBox">
                    <ul class="optionUL">
                        <%for(var i in threeArea){%>
                        <li value="<%=threeArea[i].id%>"><%=threeArea[i].name%></li>
                        <%}%>
                    </ul>
                </div>
                <%}%>
            </div>
        </div>
        <input type="text" placeholder="请输入具体门牌号" id="address"
               value="<%=list.address%>">
    </div>
    <div class="shopMsg">
        <ul class="clearfix">
            <li>
                <p class="title">营业执照编号</p>
                <input type="number" value="<%=list.phone%>" id="yybh" placeholder="营业执照编号">
            </li>
            <li>
                <p class="title">发证日期</p>
                <div>

                    <input name="test" id="startTime1"
                           value="<%if(list.comBusinessDate){%><%=getYMDTime(list.comBusinessDate)%><%}%>"
                           class="demo-test-date demo-test-datetime demo-test-time demo-test-credit"
                           placeholder="发证日期"
                           data-type="day"/>
                    <i class="icon iconfont icon-ico_calendar icon10"></i>
                    <div class="settings" style="display:none;">
                        <select name="demo" id="demo01">
                            <option value="date">日期</option>
                        </select>
                    </div>
                </div>
            </li>
            <li>
                <p class="title">有效日期</p>
                <div class="yj-demo-time">
                    <div class="yj-date">
                        <span>
                            <%if(list.comBusinessDateStart){%><%=getYMDTime(list.comBusinessDateStart)%>-<%=getYMDTime(list.comBusinessDateEnd)%><%}else{%>开始时间-结束时间<%}%>
                        </span>
                        <i class="iconfont icon-ico_calendar"></i>
                    </div>
                </div>
            </li>
        </ul>
    </div>

    <div class="uploadPic">
        <p class="title">营业执照照片</p>
        <div class="cont layui-upload" style="overflow: hidden" class="imgBox" id="yyImg">
            <%if(list.storeImg){%>
            <%for(var i=0;i< list.storeImg.length;i++){%>
            <div class="imgBox">
                <img src="<%=list.storeImg[i]%>"
                     real-src="<%=list.storeImg[i]%>"
                     style="width: 100%;height: 100%" alt="">
                <div class="del" onclick="delImg(this)"></div>
            </div>
            <%}%>
            <%}%>
            <span onclick="uploadIcon(this)" class="layui-btn test2">
                <i class="icon iconfont icon-ico_plus"></i>
            </span>
        </div>
    </div>
    <ul class="goot-goot-putong s1">
        <li><input type="checkbox" name="生产商" value="" id="shcheck1"
                   onclick="shows1(this)" class="selectPro <%if(isCheck(list.manufacturerProvider,1)){%>" checked><%}else{%>"><%}%>
            该企业为生产商
        </li>
    </ul>
    <div class="qyshow1 <%if(isCheck(list.manufacturerProvider,1)){%>" style="display: block"><%}else{%>"><%}%>
        <div class="shopMsg">
            <ul class="clearfix">
                <li>
                    <p class="title">医疗器械注册证编号</p>
                    <input type="number" value="<%=list.phone%>" id="ylnum"
                           placeholder="医疗器械注册证编号" value="<%=list.mfNum%>">
                </li>
                <li>
                    <p class="title">批准日期</p>
                    <div>

                        <input name="test" id="startTime2"
                               class="demo-test-date demo-test-datetime demo-test-time demo-test-credit"
                               placeholder="<%if(list.mfRegisterDate){%><%=getYMDTime(list.mfRegisterDate)%><%}else{%>批准日期<%}%>"
                               value="<%if(list.mfRegisterDate){%><%=getYMDTime(list.mfRegisterDate)%><%}else{%>批准日期<%}%>"
                               data-type="day"/>
                        <i class="icon iconfont icon-ico_calendar icon10"></i>
                        <div class="settings" style="display:none;">
                            <select name="demo" id="demo03">
                                <option value="date">日期</option>
                            </select>
                        </div>
                    </div>
                </li>
                <li>
                    <p class="title">有效日期</p>
                    <div id="time02">
                        <div class="yj-demo-time">
                            <div class="yj-date">
                                <span>
                                    <%if(list.mfRegisterDateStart){%><%=getYMDTime(list.mfRegisterDateStart)%>-<%=getYMDTime(list.mfRegisterDateEnd)%><%}else{%>开始时间-结束时间<%}%>
                                </span><i class="iconfont icon-ico_calendar"></i>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
        <div class="uploadPic">
            <p class="title">医疗器械注册证照片</p>
            <div class="cont layui-upload" style="overflow: hidden" class="imgBox" id="ylImg">
                <%if(list.mfRegisterImg){%>
                <%for(var i=0;i< list.mfRegisterImg.length;i++){%>
                <div class="imgBox">
                    <img src="<%=list.mfRegisterImg[i]%>"
                         real-src="<%=list.mfRegisterImg[i]%>"
                         style="width: 100%;height: 100%" alt="">
                    <div class="del" onclick="delImg(this)"></div>
                </div>
                <%}%>
                <%}%>
                <span onclick="uploadIcon(this)" class="layui-btn test2"><i
                        class="icon iconfont icon-ico_plus"></i></span>
            </div>
        </div>
        <div class="shopMsg s1">
            <ul class="clearfix">
                <li>
                    <p class="title">生产许可证</p>
                    <input type="number" value="<%=list.licenceNum%>" id="scykCard"
                           placeholder="编号">
                </li>
                <li>
                    <p class="title">发证日期</p>
                    <div>

                        <input name="test" id="startTime3"
                               class="demo-test-date demo-test-datetime demo-test-time demo-test-credit"
                               placeholder="<%if(list.licenceDate){%><%=getYMDTime(list.licenceDate)%><%}else{%>发证日期<%}%>"
                               value="<%if(list.licenceDate){%><%=getYMDTime(list.licenceDate)%><%}else{%>发证日期<%}%>"
                               data-type="day"/>
                        <i class="icon iconfont icon-ico_calendar icon10"></i>
                        <div class="settings" style="display:none;">
                            <select name="demo" id="demo07">
                                <option value="date">日期</option>
                            </select>
                        </div>
                    </div>
                </li>
                <li>
                    <p class="title">有效日期</p>
                    <div id="time03">
                        <div class="yj-demo-time">
                            <div class="yj-date">
                                <span>
                                    <%if(list.licenceDateStart){%><%=getYMDTime(list.licenceDateStart)%>-<%=getYMDTime(list.licenceDateEnd)%><%}else{%>开始时间-结束时间<%}%>
                                </span><i class="iconfont icon-ico_calendar"></i>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
        <div class="uploadPic">
            <p class="title">生产许可证照片</p>
            <div class="cont layui-upload" style="overflow: hidden" class="imgBox" id="scImg">
                <%if(list.licenceImg){%>
                <%for(var i=0;i< list.licenceImg.length;i++){%>
                <div class="imgBox">
                    <img src="<%=list.licenceImg[i]%>"
                         real-src="<%=list.licenceImg[i]%>"
                         style="width: 100%;height: 100%" alt="">
                    <div class="del" onclick="delImg(this)"></div>
                </div>
                <%}%>
                <%}%>
                <span onclick="uploadIcon(this)" class="layui-btn" id="test1"><i
                        class="icon iconfont icon-ico_plus"></i></span>
            </div>
        </div>

        <div class="uploadPic n1">
            <p class="title" class="border1">其它资料照片</p>
            <div class="cont layui-upload" style="overflow: hidden" class="imgBox"
                 id="qtImg">
                <%if(list.licenceDescImg){%>
                <%for(var i=0;i< list.licenceDescImg.length;i++){%>
                <div class="imgBox">
                    <img src="<%=list.licenceDescImg[i]%>" real-src="<%=list.licenceDescImg[i]%>"
                         style="width: 100%;height: 100%" alt="">
                    <div class="del" onclick="delImg(this)"></div>
                </div>
                <%}%>
                <%}%>
                <span onclick="uploadIcon(this)" class="layui-btn test2"><i
                        class="icon iconfont icon-ico_plus"></i></span>
            </div>
        </div>
    </div>
    <ul class="goot-goot-putong s1">
        <li><input type="checkbox" name="供应商" value="" id="shcheck2" onclick="shows2(this)"
                   class="selectPro <%if(isCheck(list.manufacturerProvider,1)){%>" checked><%}else{%>"><%}%> 该企业为供应商
        </li>
    </ul>
    <div class="qyshow2 <%if(isCheck(list.manufacturerProvider,1)){%>" style="display: block"><%}else{%>"><%}%>
        <div class="shopMsg">
            <ul class="clearfix">
                <li>
                    <p class="title">医疗器械经营许可证</p>
                    <input type="number" value="<%=list.proNum%>" id="ylxkz"
                           placeholder="医疗器械经营许可证">
                </li>
                <li>
                    <p class="title">批准日期</p>
                    <div>

                        <input name="test" id="startTime4"
                               class="demo-test-date demo-test-datetime demo-test-time demo-test-credit"
                               placeholder="<%if(list.proDate){%><%=getYMDTime(list.proDate)%><%}else{%>批准日期<%}%>"
                               value="<%if(list.proDate){%><%=getYMDTime(list.proDate)%><%}else{%>批准日期<%}%>"
                               data-type="day"/>
                        <i class="icon iconfont icon-ico_calendar icon10"></i>
                        <div class="settings" style="display:none;">
                            <select name="demo" id="demo05">
                                <option value="date">日期</option>
                            </select>
                        </div>
                    </div>
                </li>
                <li>
                    <p class="title">有效日期</p>
                    <div id="time04">
                        <div class="yj-demo-time">
                            <div class="yj-date">
                                <span>
                                    <%if(list.proDateStart){%><%=getYMDTime(list.proDateStart)%>-<%=getYMDTime(list.proDateEnd)%><%}else{%>开始时间-结束时间<%}%>
                                </span><i class="iconfont icon-ico_calendar"></i>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>

        <div class="uploadPic">
            <p class="title">医疗器械经营许可证照片</p>
            <div class="cont layui-upload" style="overflow: hidden" class="imgBox" id="ylxkzimg">
                <%if(list.proImg){%>
                <%for(var i=0;i< list.proImg.length;i++){%>
                <div class="imgBox">
                    <img src="<%=list.proImg[i]%>"
                         real-src="<%=list.proImg[i]%>"
                         style="width: 100%;height: 100%" alt="">
                    <div class="del" onclick="delImg(this)"></div>
                </div>
                <%}%>
                <%}%>
                <span onclick="uploadIcon(this)" class="layui-btn test2"><i
                        class="icon iconfont icon-ico_plus"></i></span>
            </div>
        </div>
        <div class="uploadPic n1">
            <p class="title" class="border1">其它资料照片</p>
            <div class="cont layui-upload" style="overflow: hidden" class="imgBox"
                 id="qtzlImg">
                <%if(list.proDescImg){%>
                <%for(var i=0;i< list.proDescImg.length;i++){%>
                <div class="imgBox">
                    <img src="<%=list.proDescImg[i]%>" real-src="<%=list.proDescImg[i]%>"
                         style="width: 100%;height: 100%" alt="">
                    <div class="del" onclick="delImg(this)"></div>
                </div>
                <%}%>
                <%}%>
                <span onclick="uploadIcon(this)" class="layui-btn test2"><i
                        class="icon iconfont icon-ico_plus"></i></span>
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="option2">
    <%for(var i = 0; i < list.length; i++){%>
    <li class="optionItems" value="<%=i%>"><%=list[i]%></li>
    <%}%>
</script>
<script type="text/html" id="selectTagTmp">
    <div class="select-box-header">
        <span class="text"><%=title%></span> <i class="iconfont icon-ico_arrow_down"></i>
    </div>
    <div class="optionBox">
        <ul class="optionUL">
            <%for(var i in list){%>
            <li value="<%=list[i].id%>"><%=list[i].name%></li>
            <%}%>
        </ul>
    </div>
</script>
<!--下拉选择模板带全部-->
<script type="text/html" id="selectTagTmpAll">
    <div class="select-box-header">
        <span class="text"><%=title%></span> <i class="iconfont icon-ico_arrow_down"></i>
    </div>
    <div class="optionBox">
        <ul class="optionUL">
            <%for(var i=0;i< list.length;i++){%>
            <li value="<%=list[i].id%>" data-pnid="<%if(list[i].pnid){%><%=list[i].pnid%><%}%>">
                <%if(list[i].name){%><%=list[i].name%><%}else{%><%=list[i].content%><%}%>
            </li>
            <%}%>
        </ul>
    </div>
</script>
<script type="text/html" id="addGoodsTmp">
    <div class="goods-select-box">
        <div class="goods-select">
            <div class="goods-select-title">品牌</div>
            <div class="selectBox" id="yj-add-brand">
                <div class="select-box-header">
                    <input type="text" id="brandName" onkeyup="changeBrand(this)" value="<%=list.brandName%>"
                           placeholder="品牌"><i class="iconfont icon-ico_arrow_down"></i>
                </div>
                <div class="optionBox">
                    <ul class="optionUL">
                        <%for(var i=0;i< brandData.length;i++){%>
                        <li value="<%=brandData[i].id%>"><%=brandData[i].name%></li>
                        <%}%>
                    </ul>
                </div>
            </div>
        </div>
        <div class="goods-select">
            <div class="goods-select-title">系列</div>
            <div class="selectBox" onkeyup="changeSeries(this)" id="yj-add-series">
                <div class="select-box-header">
                    <input type="text" id="seriesName" value="<%=list.seriesName%>" placeholder="系列"><i
                        class="iconfont icon-ico_arrow_down"></i>
                </div>
            </div>
        </div>
        <div class="goods-select">
            <div class="goods-select-title">供应商</div>
            <div class="selectBox" id="yj-add-provider">
                <div class="select-box-header">
                    <span class="text">
                        <%if(list.pid){%>
                                <%for(var i=0;i< providerData.length;i++){%>
                                    <%if(list.pid==providerData[i].id){%>
                                        <%=providerData[i].name%>
                                    <%}%>
                                <%}%>
                            <%}else{%>
                                供应商
                            <%}%>
                    </span> <i class="iconfont icon-ico_arrow_down"></i>
                </div>
                <div class="optionBox">
                    <ul class="optionUL">
                        <%for(var i=0;i< providerData.length;i++){%>
                        <li value="<%=providerData[i].id%>"><%=providerData[i].name%></li>
                        <%}%>
                    </ul>
                </div>
            </div>
        </div>
        <div class="goods-select">
            <div class="goods-select-title">类型</div>
            <div class="selectBox" id="yj-add-type">
                <div class="select-box-header">
                        <span class="text">
                            <%if(list.properties && list.properties[5]){%>
                                <%for(var i=0;i< typeData.length;i++){%>
                                    <%if(list.properties[5]==typeData[i].id){%>
                                        <%=typeData[i].content%>
                                    <%}%>
                                <%}%>
                            <%}else{%>
                                类型
                            <%}%>
                        </span> <i class="iconfont icon-ico_arrow_down"></i>
                </div>
                <div class="optionBox">
                    <ul class="optionUL">
                        <%for(var i=0;i< typeData.length;i++){%>
                        <li value="<%=typeData[i].id%>" data-pnid="<%=typeData[i].pnid%>"><%=typeData[i].content%></li>
                        <%}%>
                    </ul>
                </div>
            </div>
        </div>
        <div class="goods-select">
            <div class="goods-select-title">更换周期</div>
            <div class="selectBox" id="yj-add-zhouqi">
                <div class="select-box-header">
                    <span class="text">
                        <%if(list.properties && list.properties[6]){%>
                            <%for(var i=0;i< zhouqiData.length;i++){%>
                                <%if(list.properties[6]==zhouqiData[i].id){%>
                                    <%=zhouqiData[i].content%>
                                <%}%>
                            <%}%>
                        <%}else{%>
                            更换周期
                        <%}%>
                    </span> <i class="iconfont icon-ico_arrow_down"></i>
                </div>
                <div class="optionBox">
                    <ul class="optionUL">
                        <%for(var i=0;i< zhouqiData.length;i++){%>
                        <li value="<%=zhouqiData[i].id%>" data-pnid="<%=zhouqiData[i].pnid%>">
                            <%=zhouqiData[i].content%>
                        </li>
                        <%}%>
                    </ul>
                </div>
            </div>
        </div>
        <div class="goods-select">
            <div class="goods-select-title">包装</div>
            <div class="selectBox">
                <input type="text" value="<%=list.properties[7]%>" class="yj-input fl" id="yj-add-baozhuang"
                       data-pnid="7" style="width: 75%">
                <span style="float: right">片裝</span>
            </div>
        </div>
        <div class="clearfix"></div>
        <div class="goods-select">
            <div class="goods-select-title">生产商</div>
            <div class="selectBox" id="yj-add-shengchan">
                <div class="select-box-header">
                    <span class="text">
                        <%if(list.createid){%>
                            <%for(var i=0;i< shengchanData.length;i++){%>
                                <%if(list.createid==shengchanData[i].id){%>
                                    <%=shengchanData[i].name%>
                                <%}%>
                            <%}%>
                        <%}else{%>
                            生产商
                        <%}%>
                    </span> <i class="iconfont icon-ico_arrow_down"></i>
                </div>
                <div class="optionBox">
                    <ul class="optionUL">
                        <%for(var i=0;i< shengchanData.length;i++){%>
                        <li value="<%=shengchanData[i].id%>"><%=shengchanData[i].name%></li>
                        <%}%>
                    </ul>
                </div>
            </div>
        </div>
        <div class="goods-select">
            <div class="goods-select-title">质保时长/天</div>
            <div class="selectBox">
                <%if(list.properties && list.properties[8]){%>
                <input type="text" placeholder="天数" value="<%=list.properties[8]%>" class="yj-input fl" id="yj-add-day"
                       data-pnid="8">
                <%}else{%>
                <input type="text" placeholder="天数" class="yj-input fl" id="yj-add-day" data-pnid="8">
                <%}%>
            </div>
        </div>
        <div class="clearfix"></div>
        <div class="goods-select goods-range">
            <div class="goods-select-title">现货范围</div>
            <div class="goods-range-body" onclick="openGoodsRange('现货','<%=isUpdate%>')">设定现货范围</div>
        </div>
        <div class="goods-select goods-range">
            <div class="goods-select-title">定制范围</div>
            <div class="goods-range-body" onclick="openGoodsRange('定制','<%=isUpdate%>')">设定定制范围</div>
        </div>
        <div style="clear: both"></div>
    </div>
    <form class="layui-form" action="">
        <div class="goods-type">
            常规商品
            <!--<div class="layui-form-item" pane="">
                <div class="layui-input-block">
                    <input type="checkbox" lay-filter="defaultGoods"  name="type" value="0" lay-skin="primary" title="常规商品" checked>
                </div>
            </div>-->
        </div>
        <div class="yj-from" style="display: block;">
            <!--<div class="goods-vip-btn">
                <div class="goods-vip-left">会员折扣</div>
                <%if(list.ugDiscount && list.ugDiscount.length>0){%>
                <div class="goods-vip-right active" onclick="changeVipStatus(this)">
                    <%}else{%>
                    <div class="goods-vip-right" onclick="changeVipStatus(this)">
                        <%}%>
                        <div class="yj-radio"></div>
                        <span>参与会员折扣</span>
                        &lt;!&ndash;<em onclick="openSettingVip(this)">设置</em>&ndash;&gt;
                    </div>
                </div>
                <div style="clear: both"></div>-->

            <div class="goods-select-box">
                <div class="goods-select goods-range">
                    <div class="goods-select-title">零售价</div>
                    <div class="goods-range-body" onclick="openZeroPrice(1)">设定零售价</div>
                </div>
                <div class="goods-select goods-range">
                    <div class="goods-select-title">提成</div>
                    <div class="goods-range-body" onclick="openSettingTicheng()">设定提成</div>
                </div>
                <div style="clear: both"></div>
            </div>

        </div>
        <div class="goods-type">
            积分商品
            <!--<div class="layui-form-item" pane="">
                <div class="layui-input-block">
                    <%if(list.type==0){%>
                    <input type="checkbox" name="type" value="1" lay-filter="scoreGoods" lay-skin="primary" title="积分商品" >
                    <%}else{%>
                    <input type="checkbox" name="type" value="1" lay-filter="scoreGoods" lay-skin="primary" title="积分商品" checked >
                    <%}%>
                </div>
            </div>-->
        </div>
        </div>

        <div class="yj-from goods-select-box" style="display: block">
            <div class="goods-select goods-range">
                <div class="goods-select-title">积分价</div>
                <div class="goods-range-body" onclick="openZeroPrice(4)">设定积分价</div>
            </div>
            <div class="goods-select">
                <div class="goods-select-title">兑换数量上限</div>
                <div class="">
                    <%if(list.integralNum){%>
                    <input type="text" placeholder="数量" value="<%=list.integralNum%>" id="yj-add-integralNum"
                           class="yj-input">
                    <%}else{%>
                    <input type="text" placeholder="数量" id="yj-add-integralNum" class="yj-input">
                    <%}%>
                </div>
            </div>
            <div class="goods-select " style="width: 100%;height: auto;">
                <div class="goods-select-title">有效期</div>
                <div class="yj-demo-time" id="yj-add-time">
                    <div class="yj-date">
                        <%if(list.integralStartTimeNew){%>
                        <span><%=list.integralStartTimeNew%>-<%=list.integralEndTimeNew%></span><i
                            class="iconfont icon-ico_calendar"></i>
                        <%}else{%>
                        <span>开始时间-结束时间</span><i class="iconfont icon-ico_calendar"></i>
                        <%}%>
                    </div>
                </div>
            </div>

            <div style="clear: both"></div>
        </div>
        <div class="goods-select-box" style="height: 50px;">
            <div class="goods-select goods-youxiaoqi" style="width: 100%;height: auto;">
                <form class="layui-form" action="">
                    <div class="layui-form-item" pane="">
                        <div class="layui-input-block yj-check-input">
                            <%if(list.nowRemind){%>
                            <input type="checkbox" name="" checked="checked" lay-filter="kucun-yj" lay-skin="primary"
                                   title="当库存低于<input value='<%=list.nowRemind%>' onclick='quakooUtils.stopEventBubble()' id='yj-add-kucun' class='yj-input' placeholder='数量'>触发警报">
                            <%}else{%>
                            <input type="checkbox" name="" lay-filter="kucun-yj" lay-skin="primary"
                                   title="当库存低于<input readonly='' onclick='quakooUtils.stopEventBubble()' id='yj-add-kucun' class='yj-input' placeholder='数量'>触发警报">
                            <%}%>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </form>
    <!-- 注册医疗信息 -->
    <ul class="zhuceInfo">
        <li class="zhuceInfo-first">
            <span class="zhuceInfo-items">医疗器械注册信息</span>
            <i class="iconfont icon-ico_arrow_down"></i>
        </li>
        <li>
            <ul class="zhuceUl">
                <li class="lingshou l1">
                    <div class="goot-select">
                        <div class="goot-items">注册证号</div>
                        <div class="goot-items1"><span class="guoxie">国械注准</span>
                            <input type="text" placeholder="输入" id="nirNum" value="<%=list.nirNum?list.nirNum:''%>"
                                   class="guoInput"></div>
                    </div>
                    <div class="goot-select">
                        <div class="goot-items">注册时间</div>
                        <div class="goot-items1">
                            <input class="guoTime demo-test-date demo-test-datetime demo-test-time demo-test-credit"
                                   data-type="day" placeholder="选择时间" id="nirNumDate" value="<%=list.nirNumDate%>"/>
                            <i class="iconfont icon-ico_calendar icon11"></i>
                        </div>
                        <div class="settings" style="display:none;">
                            <select name="demo" id="yjdemo">
                                <option value="date">日期</option>
                            </select>
                        </div>
                    </div>
                </li>
                <li class="guoxieLast uploadPic layui-upload" id="imgBox">
                    <div>注册证图片 <span>1-3 张</span></div>
                    <div style="overflow: hidden">
                        <%if(list.nirImg){%>
                        <%for(var i=0;i< list.nirImg.length;i++){%>
                        <div class="imgBox">
                            <img src="<%=list.nirImg[i]%>" real-src="<%=list.nirImg[i]%>"
                                 style="width: 100%;height: 100%" alt="">
                            <div class="del" onclick="delRegImg(this)"></div>
                        </div>
                        <%}%>
                        <%if(list.nirImg.length<3){%>
                        <span onclick="uploadImg(this)" class="layui-btn" id="test2"><i
                                class="icon iconfont icon-ico_plus"></i></span>
                        <%}%>
                        <%}else{%>
                        <span onclick="uploadImg(this)" class="layui-btn" id="test2"><i
                                class="icon iconfont icon-ico_plus"></i></span>
                        <%}%>
                    </div>
                </li>
            </ul>
        </li>
    </ul>
    </div>

</script>

<script src="./medical.js"></script>
<!--员工列表开始时列表-->
<script type="text/html" id="yuangongList">
    <li class="first">
        <div class="ygList1">姓名</div>
        <div class="ygList2">职位</div>
        <div class="ygList3">性别</div>
        <div class="ygList4">手机号</div>
        <div class="ygList5">权限设置</div>
    </li>
    <%for(var i = 0; i < list.length; i++){%>
    <li class="hideBorder">
        <div class="others selectAllXiaLa">
            <span class="yuanLeft"><%if(list[i][0].subName)%><%=list[i][0].subName%><%else{%>无门店信息<%}%></span>
            <i class="iconfont icon-ico_arrow_down yuanRight"></i>
        </div>
        <ul class="showYuanList showAllXiaLa">
            <%for(var key = 0; key < list[i].length; key++){%>
            <li>
                <div class="ygList1"><%=list[i][key].name%></div>
                <div class="ygList2"><%=list[i][key].job%></div>
                <%if(list[i][key].sex == 0)%>
                <div class="ygList3">男</div>
                <%else if(list[i][key].sex == 1){%>
                <div class="ygList3">女</div>
                <%}else{%>
                <div class="ygList3">-</div>
                <%}%>
                <div class="ygList4"><%=list[i][key].phone%></div>
                <div class="ygList5">
                    <span class="duoXuans"><i class="iconfont icon-ico_check"></i></span> 医疗器械负责人
                    <span class="duoXuans"><i class="iconfont icon-ico_check"></i></span> 质量管理人
                </div>
            </li>
            <%}%>
        </ul>
    </li>
    <%}%>
</script>
<!--员工列表体检/培训记录模板-->
<!--头部模板-->
<script type="text/html" id="ygTjReloadListHead">
    <div class="tjHeader">
        <%if(id == 'ygLi3'){%>
        <div class="tjLeft clearfix">体检记录</div>
        <%}else if(id == 'ygLi2'){%>
        <div class="tjLeft clearfix">培训记录</div>
        <%}%>
        <div class="tjRight clearfix">
            <div class="selectBox tj2" id="selectShop">

            </div>
            <div class="selectBox tj3" id="selectShopEmployer">
                <div class="select-box-header">
                    <%if(list2){%>
                    <span class="text"><%=yuangong%></span> <i class="iconfont icon-ico_arrow_down"></i>
                    <%}else{%>
                    <span class="text">员工</span> <i class="iconfont icon-ico_arrow_down"></i>
                    <%}%>
                </div>
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="ygTjReloadList">
    <div class="mainGoodList">
        <div class="goot-select">
            <div class="goot-items">编号</div>
            <input type="text" placeholder="编号" id="ygTjReloadNum" class="proNames"
                   value='<%if(list2 && list2.length > 0 && list2[0].num){%><%=list2[0].num%><%}%>'>
        </div>
        <%if(id == 'ygLi3'){%>
        <div class="goot-select">
            <div class="goot-items">文化程度</div>
            <div class="selectBox" id="ygTjReloadLeval">
                <div class="select-box-header">
                    <span class="text"><%if(list2 && list2.length > 0){%><%=list2[0].education%><%}else{%>文化程度<%}%></span>
                    <i class="iconfont icon-ico_arrow_down"></i>
                </div>
                <div class="optionBox">
                    <ul class="optionUL">
                        <li>小学</li>
                        <li>初中</li>
                        <li>高中</li>
                        <li>本科</li>
                        <li>研究生</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="goot-select">
            <div class="goot-items">职位</div>
            <div class="selectBox" id="ygTjReloadJob">
                <div class="select-box-header">
                    <span class="text"><%if(list2 && list2.length > 0 && list2[0].job){%><%=list2[0].job%><%}else{%>职位<%}%></span>
                    <i class="iconfont icon-ico_arrow_down"></i>
                </div>
                <div class="optionBox">
                    <ul class="optionUL">
                        <%for(var i = 0; i < list.length; i++){%>
                        <li><%=list[i]%></li>
                        <%}%>
                    </ul>
                </div>
            </div>
        </div>
        <div class="goot-select">
            <div class="goot-items">从业年限</div>

            <input type="text" placeholder="输入" class="proNames" id="ygTjReloadYear"
                   value='<%if(list2 && list2.length > 0){%><%=list2[0].workYear%><%}%>'>
        </div>
        <div class="goot-select">
            <div class="goot-items">体检日期</div>
            <div class="goot-items1">
                <input class="guoTime g1 demo-test-date demo-test-datetime demo-test-time demo-test-credit"
                       data-type="day" placeholder="选择日期" id="ygTjDate1"
                       value='<%if(list2 && list2.length > 0){%><%=date%><%}%>' autocomplete="off" readonly/>
                <i class="iconfont icon-ico_calendar icon11"></i>
            </div>
            <div class="settings" style="display:none;">
                <select name="demo" id="ygTjDate">
                    <option value="date">选择日期</option>
                </select>
            </div>
        </div>
        <div class="goot-select">
            <div class="goot-items">体检医院</div>
            <input type="text" placeholder="输入" class="proNames" id="ygTjReloadYy"
                   value='<%if(list2 && list2.length > 0){%><%=list2[0].trainUnit%><%}%>'>
        </div>
    </div>
    <div class="pxInput">
        <div class="pxDanwei">体检内容</div>
        <textarea name="pxIn" class="pxIn" id="ygTpNeiRong"><%if(list2 && list2.length > 0){%><%=list2[0].trainContent%><%}else{%><%}%></textarea>
        <div class="pxDanwei">体检结果</div>
        <textarea name="pxIn" class="pxIn" id="tjieguo"><%if(list2 && list2.length > 0){%><%=list2[0].examinationOrder%><%}else{%><%}%></textarea>
        <div class="pxDanwei">备注</div>
        <input type="text" class="beizhu" placeholder="备注" id="tjbeizhu"
               value='<%if(list2 && list2.length > 0){%><%=list2[0].desc%><%}%>'>
    </div>
    <%}else if(id == 'ygLi2'){%>
    <div class="goot-select">
        <div class="goot-items">职位</div>
        <div class="selectBox" id="ygTjReloadJob">
            <div class="select-box-header">
                <span class="text"><%if(list2 && list2.length > 0 && list2[0].job){%><%=list2[0].job%><%}else{%>职位<%}%></span>
                <i class="iconfont icon-ico_arrow_down"></i>
            </div>
            <div class="optionBox">
                <ul class="optionUL">
                    <%for(var i = 0; i < list.length; i++){%>
                    <li><%=list[i]%></li>
                    <%}%>
                </ul>
            </div>
        </div>
    </div>
    <div class="goot-select">
        <div class="goot-items">考试成绩</div>
        <input type="text" placeholder="输入" class="proNames" id="ygPxReloadSch"
               value='<%if(list2 && list2.length > 0){%><%=list2[0].tests%><%}%>'>
    </div>
    <div class="goot-select">
        <div class="goot-items">授课人</div>
        <input type="text" placeholder="输入" class="proNames" id="ygPxReloadSkr"
               value='<%if(list2 && list2.length > 0){%><%=list2[0].lecturer%><%}%>'>
    </div>
    <div class="goot-select">
        <div class="goot-items">培训形式</div>
        <input type="text" placeholder="输入" class="proNames" id="ygPxReloadXs"
               value='<%if(list2 && list2.length > 0){%><%=list2[0].trainForm%><%}%>'>
    </div>
    <div class="goot-select">
        <div class="goot-items">培训单位</div>
        <input type="text" placeholder="输入" class="proNames" id="ygTjReloadYy"
               value='<%if(list2 && list2.length > 0){%><%=list2[0].trainUnit%><%}%>'>
    </div>
    </div>
    <div class="pxInput">
        <div class="pxDanwei">培训内容</div>
        <textarea name="pxIn" class="pxIn" id="ygTpNeiRong"><%if(list2 && list2.length > 0){%><%=list2[0].trainContent%><%}else{%><%}%></textarea>
        <div class="pxDanwei">备注</div>
        <input type="text" class="beizhu" placeholder="备注" id="tjbeizhu"
               value='<%if(list2 && list2.length > 0){%><%=list2[0].desc%><%}%>'>
    </div>
    <%}%>

</script>
<!--下拉选择模板-->
<script type="text/html" id="selectTagInputTmp">
    <div class="select-box-header">
        <input type="text" id="seriesName" value="<%=title%>" placeholder="系列"><i
            class="iconfont icon-ico_arrow_down"></i>
    </div>
    <div class="optionBox">
        <ul class="optionUL">
            <%for(var i=0;i< list.length;i++){%>
            <li value="<%=list[i].id%>" data-pnid="<%if(list[i].pnid){%><%=list[i].pnid%><%}%>">
                <%if(list[i].name){%><%=list[i].name%><%}else{%><%=list[i].content%><%}%>
            </li>
            <%}%>
        </ul>
    </div>
</script>
<!--提成-->
<script type="text/html" id="tiChengTmp">
    <div class="ticheng-checkbox">
        <form class="layui-form" action="">
            <div class="layui-input-block" style="float:left;">
                <%if(group){%>
                <input type="checkbox" value="group" lay-skin="primary" title="团体统一提成" checked="checked">
                <%}else{%>
                <input type="checkbox" value="group" lay-skin="primary" title="团体统一提成">
                <%}%>
            </div>
            <div class="layui-input-block" style="float:left;">
                <%if(personal){%>
                <input type="checkbox" value="personal" lay-skin="primary" title="个人统一提成" checked="checked">
                <%}else{%>
                <input type="checkbox" value="personal" lay-skin="primary" title="个人统一提成">
                <%}%>
            </div>
        </form>
    </div>
    <table class="table  table-self table-ticheng">
        <tr class="bg-gray">
            <th class="bg-gray">门店名称</th>
            <th class="bg-gray">团体</th>
            <th class="bg-gray">个人</th>
        </tr>
        <%for(var i=0;i< shopData.length;i++){%>
        <%if(commissionJson[shopData[i].id]){%>
        <tr>
            <td><%=shopData[i].name%></td>
            <%if(group){%>
            <td><input class="tuanduiInput" type="number" data-id="<%=shopData[i].id%>"
                       value="<%=commissionJson[shopData[i].id].price%>" placeholder="0"></td>
            <%}else{%>
            <td><input class="tuanduiInput" type="number" data-id="<%=shopData[i].id%>" placeholder="0"
                       disabled="disabled"></td>
            <%}%>
            <%if(personal){%>
            <td><input class="gerenInput" type="number" data-id="<%=shopData[i].id%>"
                       value="<%=commissionJson[shopData[i].id].users%>" placeholder="0"></td>
            <%}else{%>
            <td><input class="gerenInput" type="number" data-id="<%=shopData[i].id%>" placeholder="0"
                       disabled="disabled"></td>
            <%}%>
        </tr>
        <%}else{%>
        <tr>
            <td><%=shopData[i].name%></td>
            <%if(group){%>
            <td><input class="tuanduiInput" type="number" data-id="<%=shopData[i].id%>" placeholder="0"></td>
            <%}else{%>
            <td><input class="tuanduiInput" type="number" data-id="<%=shopData[i].id%>" placeholder="0"
                       disabled="disabled"></td>
            <%}%>
            <%if(personal){%>
            <td><input class="gerenInput" type="number" data-id="<%=shopData[i].id%>" placeholder="0"></td>
            <%}else{%>
            <td><input class="gerenInput" type="number" data-id="<%=shopData[i].id%>" placeholder="0"
                       disabled="disabled"></td>
            <%}%>
        </tr>
        <%}%>
        <%}%>
    </table>
</script>
<script>
    template.helper('isCheck', function (array, type) {
        var flag = false;
        if (!array) return flag
        for (var i = 0; i < array.length; i++) {
            flag = array[i] == type ? true : false;
            break;
        }
        return flag;
    });
    var subid = quakooUser.getUserInfo().psid;//企业/公司id
    var shopId = quakooUser.getUserInfo().sid;//企业/公司id
    var areaJson = new areaJson();
    var oneArea = areaJson.oneList;//省数据
    var winObj = {
        //首页所有商品
        shopAll: [
            {checkbox: true, valign: "middle"},
            {field: "brandName", title: "品牌", align: "left", valign: "middle"},
            {field: "seriesName", title: "系列", align: "left", valign: "middle"},
            // {field: "providerName", title: "生产企业", align: "left", valign: "middle"},
            {field: "nirNum", title: "国械注准号", align: "left", valign: "middle"},
            {
                field: "checkStatus",
                title: "销售审核",
                align: "left",
                valign: "middle",
                formatter: function (value, row, index) {
                    if (value == 0) {
                        return '<span class="xiaoShouShenHe">未通过</span>'
                    } else if (value == 1) {
                        return '<span class="xiaoShouShenHe suc">审核通过</span>'
                    }
                }
            },
            {field: "checkStatusDate", title: "验收日期", align: "left", valign: "middle", formatter: function (value, row, index) {
                    return quakooUtils.formatTimeToDay(value);
                }
            },
            {
                field: "business",
                title: "质检人员",
                align: "center",
                valign: "middle",
                formatter: function (value, row, index) {
                    return quakooUser.getUserInfo().name;
                }
            },
            {
                field: "", title: "操作", align: "center", valign: "middle", formatter: function (value, row, index) {
                    return '<button class="btn btn-primary"  onclick="updateGoods(' + row.id + ')">编辑</button>';
                }
            }
        ],
        //首页商品和库存的列表
        shopKuCunAll: [
            // {checkbox: true, valign: "middle"},
            {field: "pici", title: "批次", align: "left", valign: "middle"},
            {field: "kuc", title: "库存", align: "left", valign: "middle"},
            {field: "yxTime", title: "有效期", align: "left", valign: "middle"},
            {
                field: "", title: "操作", align: "center", valign: "middle", formatter: function (value, row, index) {
                    // return '<span class="zKuCun">总库存</span><span class="ZkuCunNum">222<i class="iconfont icon-ico_arrow_down"></i></span>';
                    return '<span>总库存</span>'
                }
            }
        ],
        //生产商、供应商列表
        gsListAll: [
            {checkbox: true, valign: "middle"},
            {field: "name", title: "企业名称", align: "left", valign: "middle"},
            {
                field: "manufacturerProvider",
                title: "企业类型",
                align: "left",
                valign: "middle",
                formatter: function (value, row, index) {
                    if (value) {
                        if (value.length == 1) {
                            if (value[0] === 1) {
                                return '生产商'
                            } else if (value[0] === 2) {
                                return '供应商'
                            }
                        } else {
                            return '生产商/供应商'
                        }
                    }
                }
            },
            {field: "userName", title: "联系人", align: "left", valign: "middle"},
            {
                field: "checkStatus", title: "审核状态", align: "left", valign: "middle",
                formatter: function (value, row, index) {
                    if (value) {
                        if (value == 1) {
                            return '通过审核';
                        } else if (value == 0) {
                            return '未通过'
                        }
                    }
                }
            },
            {field: "phone", title: "联系电话", align: "left", valign: "middle"},
            {field: "comBusinessNum", title: "营业执照编号", align: "left", valign: "middle"},
            {
                field: "comBusinessDate",
                title: "发证日期",
                align: "left",
                valign: "middle",
                formatter: function (value, row, index) {
                    return quakooUtils.formatTimeToDay(value);
                }
            },
            {
                field: "", title: "操作", align: "center", valign: "middle", formatter: function (value, row, index, e) {
                    return '<button class="btn btn-primary" onclick=\'addPros(' + JSON.stringify(row) + ')\'>编辑</button>';
                }
            }
        ],
        //证件有效期到期的企业列表弹窗
        gsGuoqiAll: [
            {checkbox: true, valign: "middle"},
            {field: "name", title: "企业名称", align: "left", valign: "middle"},
            {
                field: "manufacturerProvider",
                title: "企业类型",
                align: "left",
                valign: "middle",
                formatter: function (value, row, index) {
                    if (value) {
                        if (value.length == 1) {
                            if (value[0] === 1) {
                                return '生产商'
                            } else if (value[0] === 2) {
                                return '供应商'
                            }
                        } else {
                            return '生产商/供应商'
                        }
                    }
                }
            },
            {field: "userName", title: "联系人", align: "left", valign: "middle"},
            {field: "phone", title: "联系电话", align: "left", valign: "middle"},
            {field: "comBusinessNum", title: "营业执照编号", align: "left", valign: "middle"},
            {
                field: "comBusinessDate",
                title: "发证日期",
                align: "left",
                valign: "middle",
                formatter: function (value, row, index) {
                    return quakooUtils.formatTimeToDay(value);
                }
            },
            {
                field: "", title: "操作", align: "center", valign: "middle", formatter: function (value, row, index) {
                    return '<button class="btn btn-primary" onclick=\'addPros(' + JSON.stringify(row) + ')\'>编辑</button>';
                }
            }
        ],
        //获取未补充说明的生产商列表
        warnSPList: [
            {checkbox: true, valign: "middle"},
            {field: "brandName", title: "品牌", align: "left", valign: "middle"},
            {field: "seriesName", title: "系列", align: "left", valign: "middle"},
            {field: "providerName", title: "生产企业", align: "left", valign: "middle"},
            {field: "nirNum", title: "国械注准号", align: "left", valign: "middle"},
            {
                field: "checkStatus",
                title: "验收结果",
                align: "left",
                valign: "middle",
                formatter: function (value, row, index) {
                    if (value == 0) {
                        return '<span class="xiaoShouShenHe">未通过</span>'
                    } else if (value == 1) {
                        return '<span class="xiaoShouShenHe suc">审核通过</span>'
                    }
                }
            },
            {field: "checkStatusDate", title: "验收日期", align: "left", valign: "middle"},
            {
                field: "name",
                title: "质检人员",
                align: "center",
                valign: "middle",
                formatter: function (value, row, index) {
                    return quakooUser.getUserInfo().name;
                }
            },
            {
                field: "", title: "操作", align: "center", valign: "middle", formatter: function (value, row, index) {
                    return '<button class="btn btn-primary" onclick="updateGoods(' + row.id + ')">编辑</button>';
                }
            }
        ],
        //销售记录列表
        XSReload: [
            {checkbox: true, valign: "middle"},
            {
                field: "day", title: "销售日期", align: "left", valign: "middle", formatter: function (value, row, index) {
                    return quakooUtils.formatTimeToDay(value);
                }
            },
            {field: "uName ", title: "客户名称", align: "left", valign: "middle"},
            {field: "code", title: "商品编号", align: "left", valign: "middle"},
            {field: "model", title: "商品名称", align: "left", valign: "middle"},
            {field: "num", title: "销售数量", align: "left", valign: "middle"},
            {field: "spy", title: "生产企业", align: "left", valign: "middle"},
            {field: "quality", title: "生产许可号", align: "left", valign: "middle"},
            {field: "nirNum", title: "国械注准号", align: "left", valign: "middle"},
            {field: "guige", title: "规格", align: "left", valign: "middle"},
            {field: "spNum", title: "生产批号", align: "left", valign: "middle"},
            {field: "quality", title: "生产时间", align: "left", valign: "middle"},
            {field: "guoqi", title: "过期时间", align: "left", valign: "middle"},
            {field: "putPerson", title: "销售人员", align: "center", valign: "middle"},
            {field: "shPerson", title: "审核人员", align: "center", valign: "middle"},
            {field: "num", title: "单据编号", align: "left", valign: "middle"}
        ],
        //退货记录列表
        THReload: [
            {checkbox: true, valign: "middle"},
            {field: "stime", title: "退货日期", align: "left", valign: "middle"},
            {field: "sname ", title: "客户名称", align: "left", valign: "middle"},
            {field: "series", title: "商品编号", align: "left", valign: "middle"},
            {field: "model", title: "商品名称", align: "left", valign: "middle"},
            {field: "cycle", title: "销售数量", align: "left", valign: "middle"},
            {field: "spy", title: "生产企业", align: "left", valign: "middle"},
            {field: "quality", title: "生产许可号", align: "left", valign: "middle"},
            {field: "guoxieNum", title: "国械注准号", align: "left", valign: "middle"},
            {field: "guige", title: "规格", align: "left", valign: "middle"},
            {field: "spNum", title: "生产批号", align: "left", valign: "middle"},
            {field: "quality", title: "生产时间", align: "left", valign: "middle"},
            {field: "guoqi", title: "过期时间", align: "left", valign: "middle"},
            {field: "putPerson", title: "销售人员", align: "center", valign: "middle"},
            {field: "shPerson", title: "审核人员", align: "center", valign: "middle"},
            {field: "num", title: "单据编号", align: "left", valign: "middle"}
        ],
        //销毁记录列表
        xhReload: [
            {checkbox: true, valign: "middle"},
            {field: "stime", title: "退货日期", align: "left", valign: "middle"},
            {field: "series", title: "商品编号", align: "left", valign: "middle"},
            {field: "model", title: "商品名称", align: "left", valign: "middle"},
            {field: "cycle", title: "销售数量", align: "left", valign: "middle"},
            {field: "spy", title: "生产企业", align: "left", valign: "middle"},
            {field: "quality", title: "生产许可号", align: "left", valign: "middle"},
            {field: "guoxieNum", title: "国械注准号", align: "left", valign: "middle"},
            {field: "guige", title: "规格", align: "left", valign: "middle"},
            {field: "spNum", title: "生产批号", align: "left", valign: "middle"},
            {field: "quality", title: "生产时间", align: "left", valign: "middle"},
            {field: "guoqi", title: "过期时间", align: "left", valign: "middle"},
            {field: "putPerson", title: "销售人员", align: "center", valign: "middle"},
            {field: "shPerson", title: "审核人员", align: "center", valign: "middle"},
            {field: "num", title: "单据编号", align: "left", valign: "middle"}
        ],
        RKReload: [
            {field: "radio", title: "state", align: "center", "radio": 'true'},
            {
                field: "ctime",
                title: "入库时间",
                align: "left",
                valign: "middle",
                formatter: function (value, row, index) {
                    return quakooUtils.formatTimeToDay(value)
                }
            },
            {
                field: "clientItems",
                title: "编号",
                align: "left",
                valign: "middle",
                formatter: function (value, row, index) {
                    return value[0].bid
                }
            },
            {
                field: "clientItems",
                title: "商品名称",
                align: "left",
                valign: "middle",
                formatter: function (value, row, index) {
                    return value[0].categoryName + '-' + value[0].brandName + '-' + value[0].seriesName;
                }
            },
            {
                field: "clientItems",
                title: "验收数量",
                align: "left",
                valign: "middle",
                formatter: function (value, row, index) {
                    return value[0].num
                }
            },
            {field: "sPy", title: "生产企业", align: "left", valign: "middle"},
            {field: "productNum", title: "生产许可号", align: "left", valign: "middle"},
            {field: "guoxieNum", title: "国械注准号", align: "left", valign: "middle"},
            {field: "guige", title: "规格", align: "left", valign: "middle"},
            {field: "spNum", title: "生产批号", align: "left", valign: "middle"},
            {field: "quality", title: "生产时间", align: "left", valign: "middle"},
            {field: "guoqi", title: "过期时间", align: "left", valign: "middle"},
            {field: "ysjueguo", title: "验收结果", align: "left", valign: "middle"},
            {field: "yanshou", title: "验收日期", align: "left", valign: "middle"},
            {field: "putPerson", title: "质检人员", align: "center", valign: "middle"},
            {field: "num", title: "单据编号", align: "left", valign: "middle"},
        ]
    };
    var brand,//品牌
        series,//系列
        typeData,//类型
        shengS,//生产商
        zhouqiData,//更换周期  数据
        baozhuangData,//包装  数据
        gongS;//供应商
    var ballData;   //球数据
    var columnData;//柱数据
    var shopData;   //店铺数据


    /*员工列表开始*/
    // 员工列表开始时首页表

    // 员工列表
    var obj = [];
    quakooData.ajaxGetData(config.getUrl_medicalAppliances_getAllGongSiInfo(), {psid: quakooUser.getUserInfo().psid}, function (ret) {
        for (var k in ret.data) {
            obj.push(ret.data[k])
        }
        obj.shift()
    })

    function employList() {
        layer.open({
            type: 1, shade: 0.01,
            title: null,
            skin: 'my-skin',
            area: ['720px', '550px'],
            anim: 0,
            maxWidth: '720',
            closeBtn: 0, //显示关闭按钮
            resize: false,
            shadeClose: true, //开启遮罩关闭
            content: $('.content-view-employList'),
            btn: '关闭窗口'
        });
        var html = template('yuangongList', {list: obj})
        $('#yuangongList1').html(html);
        $('.selectAllXiaLa').click(function () {
            var index = $(".selectAllXiaLa").index($(this));
            $(this).find('i').toggleClass('icon-ico_arrow_down').toggleClass('icon-ico_arrow_up')
            $('.showAllXiaLa').eq(index).slideToggle();
        })
        $('.duoXuans').click(function () {
            $(this).toggleClass('active')
        })
    }

    function selectTimes(date) {
        //营业时间
        var opt = {};
        opt.date = {
            preset: 'date'
        };
        opt.datetime = {
            preset: 'datetime'
        };
        opt.time = {
            preset: 'time'
        };

        opt.default = {
            theme: 'mbsc-android-holo', //皮肤样式
            display: 'bubble', //显示方式
            mode: 'scroller', //日期选择模式
            dateFormat: 'yyyy-mm-dd',
            lang: 'zh',
            showNow: true,
            nowText: "今天",
            typeNum: 'day', //day：获取到日，time：获取到时，branch：获取到分；默认是获取到分
        };
        $('.settings').bind('change', function () {
            var demo = 'datetime';
            if (!demo.match(/select/i) && !date) {
                $('.demo-test-' + demo).val('');
            }
            $('.demo-test-' + demo).scroller('destroy').scroller($.extend(opt['datetime'], opt['default']));
            $('.demo').hide();
            $('.demo-' + demo).show();
        });
    }

    // start();
    var subids, //该员工的门店id
        suid, //员工的id
        job,
        education, //文化程度
        mendian, //记录门店
        yuangong, //记录员工
        zhiWeiData; //职位
    // 员工列表（体检记录弹窗）
    function tjReload(id) {
        //门店员工列表的筛选
        quakooData.ajaxGetData(config.getUrl_subordinate_getSubordinateStore(), {
            sid: quakooUser.getUserInfo().psid,
            token: quakooUser.getUserInfo().token
        }, function (ret1) {
            var html = template('ygTjReloadListHead', {list1: ret1.data, id: id});
            var index2 = layer.open({
                type: 1,
                shade: 0.01,
                title: html,
                move: '#ygTitle',
                skin: 'ygPopup my-skin1',
                area: ['360px', '550px'],
                anim: 0,
                maxWidth: '360',
                closeBtn: 0, //显示关闭按钮
                resize: false,
                shadeClose: true, //开启遮罩关闭
                content: $('.content-view-tjReload'),
                btn: ['取消', '保存'],
                yes: function (index2) {
                    layer.close(index2)
                },
                btn2: function (index2) {
                    baoCun(id)
                    return false;
                },
                success: function () {
                    $('#ygTjReloadList1').html(template('ygTjReloadList', {
                        list: [],
                        id: id,
                        list2: [],
                        date: '选择日期'
                    }));
                    $('.ygPopup').find('.layui-layer-title').css({
                        "padding": 0,
                        "overflow": 'inherit'
                    }).next().css('width', '100%');
                    //选择门店下拉框
                    var html1 = template('selectTagTmpAll', {
                        title: '选择门店',
                        list: ret1.data
                    });
                    $('#selectShop').html(html1)
                    selectTag($("#selectShop"), function (data) { //门店列表下拉框
                        yuanGong(data.value, id)
                        subids = data.value
                    })
                    $('.layui-layer .layui-layer-title span').css("marginLeft", "0px")
                }
            });
        })
        //获取职位
        quakooData.ajaxGetData(config.getUrl_user_getAllUserJob(), {
            sid: quakooUser.getUserInfo().sid,
            userType: 1
        }, function (ret) {
            zhiWeiData = ret.data;
        })
    }

    function yuanGong(id, type) {
        quakooData.ajaxGetData(config.getUrl_user_getAllUser(), {
            sid: id, //门店id
            userType: 1
        }, function (ret2) {
            if (ret2 && ret2.success) {
                if (ret2.data && ret2.data.length > 0) {
                    var html2 = template('selectTagTmpAll', {
                        title: '选择员工',
                        list: ret2.data
                    });
                    $('#selectShopEmployer').html(html2).show();
                    //员工的下拉框
                    selectTag($("#selectShopEmployer"), function (data) {
                        suid = data.value;
                        selectEmployer(type); //选择员工
                    })
                } else {
                    $('#selectShopEmployer').hide();
                }
            }
        })

    }

    function selectEmployer(type) {
        //获取员工体检记录
        if (type == 'ygLi3') {
            quakooData.ajaxGetData(config.getUrl_medicalAppliances_getPtReload(), {
                uid: suid,
                type: 1
            }, function (ret2) {
                console.log(ret2)
                if (ret2.data.length) {
                    var date = quakooUtils.formatTimeToDay(parseInt(ret2.data[0].examinationDate))
                }
                var data = {
                    list: zhiWeiData,
                    id: type,
                    list2: ret2.data,
                    date: date
                };
                var html = template('ygTjReloadList', data);
                $('#ygTjReloadList1').html(html);
                selectTag($("#ygTjReloadJob"), function (value) {  //  职位下拉框
                    job = value.text
                })
                selectTag($("#ygTjReloadLeval"), function (value) {  //  文化程度下拉框
                    education = value.text
                })
                selectTimes(date);
                $('#ygTjDate').trigger('change');
            })
        } else if (type == 'ygLi2') { //获取员工培训记录
            quakooData.ajaxGetData(config.getUrl_medicalAppliances_getPtReload(), {
                uid: suid,
                type: 2
            }, function (ret2) {
                console.log(ret2)
                var data = {list: zhiWeiData, id: type, list2: ret2.data, yuangong: yuangong};
                var html = template('ygTjReloadList', data);
                $('#ygTjReloadList1').html(html);
                selectTag($("#ygTjReloadJob"), function (value) {  //  职位下拉框
                    job = value.text
                })
            })
        }
    }

    function baoCun(id) {
        var param1 = {};
        param1.subid = subids; //员工门店id
        param1.uid = suid; //员工id
        param1.num = $('#ygTjReloadNum').val(); //编号
        param1.trainUnit = $('#ygTjReloadYy').val(); //培训单位/体检医院
        param1.trainContent = $('#ygTpNeiRong').val(); //培训内容/体检内容
        param1.desc = $('#tjbeizhu').val(); //备注
        param1.job = job; //职位
        //体检独有

        if (id == 'ygLi3') {
            param1.examinationOrder = $('#tjieguo').val(); //体检结果
            param1.workYear = quakooUtils.isNotBlack($('#ygTjReloadYear')) ? $('#ygTjReloadYear').val() : ''; //从业年限
            param1.type = 1;
            param1.examinationDate = quakooUtils.isNotBlack($('#ygTjDate1').val()) ? new Date($("#ygTjDate1").val()).getTime() : ''; //体检日期
            param1.education = quakooUtils.isNotBlack(education) ? education : ''; //文化程度
        } else if (id == 'ygLi2') {
            param1.type = 2;
        }
        //培训独有
        param1.tests = quakooUtils.isNotBlack($('#ygPxReloadSch')) ? $('#ygPxReloadSch').val() : '';  //成绩考试
        param1.trainForm = quakooUtils.isNotBlack($('#ygPxReloadXs')) ? $('#ygPxReloadXs').val() : '';  //培训形式
        param1.lecturer = quakooUtils.isNotBlack($('#ygPxReloadSkr')) ? $('#ygPxReloadSkr').val() : '';  //授课人
        if (quakooUtils.isBlack(param1.subid)) {
            layer.msg('选择门店');
            return;
        }
        if (quakooUtils.isBlack(param1.uid)) {
            layer.msg('选择员工');
            return;
        }
        if (quakooUtils.isBlack(param1.num)) {
            layer.msg('填写编号');
            return;
        }
        if (id == 'ygLi3') {
            if (quakooUtils.isBlack(param1.examinationDate)) {
                layer.msg('体检日期');
                return;
            }
            if (quakooUtils.isBlack(param1.workYear)) {
                layer.msg('workYear');
                return;
            }
            if (quakooUtils.isBlack(param1.education)) {
                layer.msg('文化程度');
                return;
            }
            if (quakooUtils.isBlack(param1.examinationOrder)) {
                layer.msg('填写体检结果');
                return;
            }
        } else if (id == 'ygLi2') {
            if (quakooUtils.isBlack(param1.tests)) {
                layer.msg('成绩考试');
                return;
            }
            if (quakooUtils.isBlack(param1.trainForm)) {
                layer.msg('培训形式');
                return;
            }
            if (quakooUtils.isBlack(param1.lecturer)) {
                layer.msg('授课人');
                return;
            }
        }
        if (quakooUtils.isBlack(param1.trainUnit)) {
            if (id == 'ygLi3') {
                layer.msg('体检医院');
            } else if (id == 'ygLi2') {
                layer.msg('培训单位');
            }
            return;
        }
        if (quakooUtils.isBlack(param1.trainContent)) {
            if (id == 'ygLi3') {
                layer.msg('体检内容');
            } else if (id == 'ygLi2') {
                layer.msg('培训内容');
            }
            return;
        }
        console.log(param1)
        quakooData.ajaxGetData(config.getUrl_medicalAppliances_addtjReload(), param1, function (ret) {
            layer.msg('保存成功')
        })
    }

    /*员工列表结束*/

    // 首页时间
    var startTime,
        scNum,
        endTime;
    date5 = new dateRange("#select-time-header .yj-demo-time");
    date5.init();
    $('#select-time-header button').click(function () {
        startTime = date5.getTime()[2];
        endTime = date5.getTime()[3];
        initPage();
        getXiaoShouReload();
        getRuKuReload();
    })
    $(function () {
        initPage();
        //获取品牌（页面及弹窗）
        quakooData.ajaxGetData(config.getUrl_productBrand_getSubAllList(), {}, function (ret) {
            if (ret && ret.success) {
                brand = ret.data;
            }
        })
        //获取属性-隐形眼镜类型/5
        quakooData.ajaxGetData(config.getUrl_productPropertyvalue_getAllList(), {pnid: 5}, function (ret) {
            typeData = ret.data
        })
        //获取属性-隐形眼镜更换周期/6
        quakooData.ajaxGetData(config.getUrl_productPropertyvalue_getAllList(), {pnid: 6}, function (ret) {
            zhouqiData = ret.data
        })
        //获取属性-隐形眼镜包装/7
        quakooData.ajaxGetData(config.getUrl_productPropertyvalue_getAllList(), {pnid: 6}, function (ret) {
            baozhuangData = ret.data
        })
        //获取生产商
        quakooData.ajaxGetData(config.getUrl_medicalAppliances_getgongSheng(), {mpId: 1}, function (ret) {
            shengS = ret.data
        })
        //获取供应商
        quakooData.ajaxGetData(config.getUrl_medicalAppliances_getgongSheng(), {mpId: 2}, function (ret) {
            gongS = ret.data
        })
        //获取属性-球
        quakooData.ajaxGetData(config.getUrl_productPropertyvalue_getAllList(), {pnid: 41}, function (ret) {
            if (ret && ret.success) {
                ballData = ret.data.sort(function (a, b) {
                    return b.content - a.content;
                });
            }
        });
        //获取属性-柱
        quakooData.ajaxGetData(config.getUrl_productPropertyvalue_getAllList(), {pnid: 42}, function (ret) {
            if (ret && ret.success) {
                columnData = ret.data.sort(function (a, b) {
                    return b.content - a.content;
                });
            }
        });
        //获取门店
        quakooData.ajaxGetData(config.getUrl_subordinate_getSubordinateStore(), {sid: subid}, function (ret) {
            if (ret && ret.success) {
                shopData = ret.data;
            }
        });
    })

    //初始化函数(首页产品列表)
    function initPage() {
        // quakooData.ajaxGetData(config.getUrl_product_getSPUPager(), { subid: quakooUser.getUserInfo().psid, type: 1 }, function (ret) {
        //     console.log(ret)
        //     var tabTwo = new TableInit({
        //         data: ret.data,
        //         method: false,
        //         type: 'client',
        //         url: false,
        //         columns: winObj.shopAll
        //     });
        // })
        // tabTwo.Init();
        var checkArray = {};
        var tabTwo = new TableInit({
            dom: '#xsjl-table',
            data: false,
            method: 'get',
            type: 'server',
            url: config.getUrl_product_getELSPUPager(),
            columns: winObj.shopAll,
            onCheckAll: function (data) {
                var len = data.length;
                for (var i = 0; i < data.length; i++) {
                    checkArray[data[i].id] = data[i].id
                }
                shouyeShowFooter(len, checkArray, 1)
            },
            onUncheckAll: function (data) {
                var len = 0;
                checkArray = {};
                shouyeShowFooter(len, checkArray)
            },
            onCheck: function (data) {
                var len = $('#xsjl-table').find('tr.selected').length;
                checkArray[data.id] = data.id;
                shouyeShowFooter(len, checkArray, 1)
            },
            onUncheck: function (data) {
                delete checkArray[data.id]
                var len = $('#xsjl-table').find('tr.selected').length;
                shouyeShowFooter(len, checkArray, 1)
            },
            callBack: function (row) {
                row.subid = quakooUser.getUserInfo().sid
                row.startTime = startTime ? startTime : '';
                row.endTime = endTime ? endTime : '';
                return row
            }
        });
        tabTwo.Init();

        //获取为补充说明商品的数量
        quakooData.ajaxGetData(config.getUrl_medicalAppliances_getNotBuCSMShop(),
            {
                subid: quakooUser.getUserInfo().sid,
                token: quakooUser.getUserInfo().token
            },
            function (ret) {
                $('.daoqiWarn').find('.notBuChongNum').html(ret.rows.length)
            })
    }

    //获取所有商品首页展示的列表
    function shouyeShowFooter(num, obj, index) {
        var botBar = '<div class="showShouyeFooter">' +
            '<span class="xuanZhongXiang">已选中' + num + '项</span>' +
            '<div class="xuanRight">' +
            '<span class="quXiaoXuanZhong">取消选中</span>' +
            '<span class="piLiangDaYin">批量打印</span>' +
            '<span class="tuiHuoBtn">退货</span>' +
            '<span class="xiaoHuiBtn">销毁</span>' +
            '<span class="shenHeTongguo">审核通过</span>' +
            '</div>' +
            '</div>';
        if (num > 0) {
            $('.body-bg').append(botBar)
            $('.showShouyeFooter').show();
            if(index == 1){
                //审核通过
                $('.shenHeTongguo').click(function () {
                    var ids = [];
                    //转换成数组
                    Object.keys(obj).forEach(function (key) {
                        ids.push(key)
                    });
                    quakooData.ajaxGetData(config.getUrl_medicalAppliances_checkAddStatus(), {ids: ids}, function (ret) {
                        if (ret && ret.success) {
                            layer.msg('审核成功')
                            initPage();
                        }
                    })
                })
                //销毁
                $('.xiaoHuiBtn').click(function () {
                    var ids = [];
                    //转换成数组
                    Object.keys(obj).forEach(function (key) {
                        ids.push(key)
                    });
                    quakooData.ajaxGetData(config.getUrl_medicalAppliances_inventoryOutBill(), {
                        ids: ids,
                        start: 2
                    }, function (ret) {
                        if (ret && ret.success) {
                            layer.msg('销毁完成');
                            initPage();
                        }
                    })
                })
                //退货
                $('.tuiHuoBtn').click(function () {
                    var ids = [];
                    //转换成数组
                    Object.keys(obj).forEach(function (key) {
                        ids.push(key)
                    });
                    quakooData.ajaxGetData(config.getUrl_medicalAppliances_inventoryOutBill(), {
                        ids: ids,
                        start: 3
                    }, function (ret) {
                        if (ret && ret.success) {
                            layer.msg('退货完成');
                            initPage();
                        }
                    })
                })
            }else if (index == 2) {
                $('.tuiHuoBtn').hide();
                $('.xiaoHuiBtn').hide();
                //审核通过入库单
                $('.shenHeTongguo').click(function () {
                    var ids = [];
                    //转换成数组
                    Object.keys(obj).forEach(function (key) {
                        ids.push(key)
                    });
                    quakooData.ajaxGetData(config.getUrl_medicalAppliances_rukuInventoryinbill(), {id: ids[0]}, function (ret) {
                        if (ret && ret.success) {
                            layer.msg('审核成功')
                            initPage();
                        }
                    })
                })

            }else if (index == 3) {
                $('.tuiHuoBtn').hide();
                $('.xiaoHuiBtn').hide();
                $('.shenHeTongguo').hide();
            }

        } else {
            $('.showShouyeFooter').hide();
        }
    }

    /*入库记录*/
    function getRuKuReload(n) {
        var checkArray = {};
        var tabFour = new TableInit({
            dom: '#rkjl-table',
            data: false,
            method: 'get',
            type: 'server',
            url: config.getUrl_medicalAppliances_getRuKuReload(),
            singleSelect : true,
            columns: winObj.RKReload,
            onCheck: function (data) {
                console.log(data)
                var len = $('#rkjl-table').find('tr.selected').length;
                checkArray[data.id] = data.id;
                shouyeShowFooter(len, checkArray, 2)
            },
            onUncheck: function (data) {
                delete checkArray[data.id]
                var len = $('#rkjl-table').find('tr.selected').length;
                shouyeShowFooter(len, checkArray, 2)
            },
            callBack: function (row) {
                row.subid = quakooUser.getUserInfo().sid;
                row.startTime = startTime ? startTime : '';
                row.endTime = endTime ? endTime : '';
                row.num = n ? n : '';
                row.type = 0;
                return row
            },
            success: function (data) {
                console.log(data)
            }
        });
        tabFour.Init();
    }

    /*入库记录按生产批号查找*/
    function scSearch() {
        scNum = $('.search-box').val();
        console.log(scNum)
        getRuKuReload(scNum);
    }

    /*销售记录*/
    function getXiaoShouReload() {
        var checkArray = {};
        var tabFour = new TableInit({
            dom: '#xsReload-table',
            data: false,
            method: 'get',
            type: 'server',
            url: config.getUrl_medicalAppliances_getXiaoShouReload(),
            columns: winObj.XSReload,
            onCheckAll: function (data) {
                var len = data.length;
                for (var i = 0; i < data.length; i++) {
                    checkArray[data[i].id] = data[i].id
                }
                shouyeShowFooter(len, checkArray, 3)
            },
            onUncheckAll: function (data) {
                var len = 0;
                checkArray = {};
                shouyeShowFooter(len, checkArray, 3)
            },
            onCheck: function (data) {
                var len = $('#xsjl-table').find('tr.selected').length;
                checkArray[data.id] = data.id;
                shouyeShowFooter(len, checkArray, 3)
            },
            onUncheck: function (data) {
                delete checkArray[data.id]
                var len = $('#xsjl-table').find('tr.selected').length;
                shouyeShowFooter(len, checkArray, 3)
            },
            callBack: function (row) {
                row.subId = quakooUser.getUserInfo().sid;
                row.startTime = startTime ? startTime : '';
                row.endTime = endTime ? endTime : '';
                return row
            }
        });
        tabFour.Init();
    }

    /*退货记录*/
    function getTuiHuoReload() {
        var tabFive = new TableInit({
            dom: '#thReload-table',
            data: false,
            method: 'get',
            type: 'server',
            url: config.getUrl_medicalAppliances_getTuiHuoReload(),
            columns: winObj.THReload,
            callBack: function (row) {
                row.subid = quakooUser.getUserInfo().sid;
                row.type = 1; //1退货 2销毁
                return row
            }
        });
        tabFive.Init();
    }

    /*销毁记录*/
    function getXiaoHuiReload() {
        var tabSix = new TableInit({
            dom: '#xhReload-table',
            data: false,
            method: 'get',
            type: 'server',
            url: config.getUrl_medicalAppliances_getTuiHuoReload(),
            columns: winObj.xhReload,
            callBack: function (row) {
                row.subid = quakooUser.getUserInfo().sid;
                row.type = 2; //1退货 2销毁
                return row
            }
        });
        tabSix.Init();
    }

    /**
     * tab切换
     * */
    $(".tab-ul-header li").click(function () {
        $(this).addClass('active').siblings().removeClass('active');
        $(".tab-item").hide().eq($(this).index()).show();
        if ($(this).index() == 1) {
            getRuKuReload();
            $(".right-info").find('.addbtn').hide();
            //隐藏产品列表和商品库存
            $('.cpListTop').hide();
        } else if ($(this).index() == 2) {
            getXiaoShouReload();
            $(".right-info").find('.addbtn').hide();
            //隐藏产品列表和商品库存
            $('.cpListTop').hide();
        } else if ($(this).index() == 0) {
            $(".right-info").find('.addbtn').show();
            $('.cpListTop').show();
        }
    });

    /**
     * 首页产品列表和商品库存tab切换
     * */
    page();
    function page() {
        $("#yj-page-table").bootstrapTable('destroy');
        $("#yj-page-table").bootstrapTable({
            url: config.getUrl_marketingcoupon_getAllList(),
            method: 'get',
            classes: "table",
            pagination: true, //是否显示分页
            sidePagination: "server", //分页方式：client客户端分页，server服务端分页（*）
            pageNumber: 1, //初始化加载第一页，默认第一页
            pageSize: 6,
            pageList: [6, 12, 18],
            sortable: false,
            sortOrder: "asc",
            showColumns: true,
            strictSearch: true,
            locale: "zh-CN",
            paginationHAlign: "center",
            clickToSelect: true,
            paginationLoop: false,
            columns: [],
            queryParams: function(param) {
                param.subid = quakooUser.getUserInfo().psid;
                param.token = quakooUser.getUserInfo().token;
                return param
            },
            onPreBody: function(data) {
                vouchertableData = [];
                for (var i = (this.pageNumber - 1) * this.pageSize; i < this.pageNumber * this.pageSize; i++) {
                    if (this.data[i]) {
                        vouchertableData.push(this.data[i])
                    }
                }
                console.log(vouchertableData)
                // var html = template("voucherList", {
                //     list: vouchertableData
                // });
                // $("#card-list1").html(html);
            }
        });
    }
    $('.tab-head-li2').click(function () {
        $('.tab-head-li2').find('div i').toggleClass('icon-ico_arrow_down').toggleClass('icon-ico_arrow_up');
        $(this).find('.tab-head-item').slideToggle();
        $('.tab-head-item li').click(function (e) {
            e.stopPropagation();
            var botBar = '<div class="showShouyeFooter">' +
                '<div class="xuanRight">' +
                '<span class="piLiangDaYin" style="background-color: rgba(65, 134, 220, 1); color: #fff; vertical-align: middle">条码打印</span>' +
                '<span class="tuiHuoBtn">退货</span>' +
                '<span class="xiaoHuiBtn">销毁</span>' +
                '</div>' +
                '</div>';
            $('.body-bg').append(botBar)
            $('.showShouyeFooter').show();
        })
    })
    function detailFormatter(index, row) {
        var html = []
        $.each(row, function (key, value) {
            html.push('<p><b>' + key + ':</b> ' + value + '</p>')
        })
        return html.join('')
    }
    //退货弹窗
    function tuihuo() {
        layer.open({
            type: 1,
            shade: 0.01,
            title: '确认销毁该批次产品？',
            skin: 'layer-recharge my-skin3',
            anim: 0,
            area: ['240px', '130px'],
            closeBtn: 0,
            resize: false,
            shadeClose: true,
            content: $('#tuiHuoToast'),
            btn: ['取消', '确定'],
            yes: function (index, layero) {
                layer.close(index)
            },
            btn2: function (index, layero) {
            },
            success: function (layero, index) {

            }

        });
    }
    //销毁弹窗
    function xiaohui() {
        layer.open({
            type: 1,
            shade: 0.01,
            title: '确认退货该批次产品？',
            skin: 'layer-recharge my-skin3',
            anim: 0,
            area: ['240px', '130px'],
            closeBtn: 0,
            resize: false,
            shadeClose: true,
            content: $('#xiaohuiToast'),
            btn: ['取消', '确定'],
            yes: function (index, layero) {
                layer.close(index)
            },
            btn2: function (index, layero) {
            },
            success: function (layero, index) {

            }
        });
    }
    $('.cpListItems').click(function () {
        $(this).addClass('active').siblings().removeClass('active');
        $('.tab-item-li').hide().eq($(this).index()).show();
        if($(this).index() == 1){
            // 获取所有商品首页(商品及库存列表)
            var data11 = [
                {pici: "111", kuc: "13", yxTime: "2019.12.31"},
                {pici: "111", kuc: "13", yxTime: "2019.12.31"},
                {pici: "111", kuc: "13", yxTime: "2019.12.31"},
                {pici: "111", kuc: "13", yxTime: "2019.12.31"}
            ]
            var tabNone = new TableInit({
                        dom: '#kcdq-table',
                        data: data11,
                        method: false,
                        type: 'client',
                        url: false,
                        columns: winObj.shopKuCunAll
                    });
            tabNone.Init();
            $('#kcdq-table').attr('data-detail-view', true)
            console.log($('#kcdq-table').attr('data-detail-view'));
        }
    })
    function kuCunWarnSP() {
        $('#table3').hide();
        $('.warn2').hide();
        $('#table4').show();
        // 获取所有商品首页(商品及库存过期列表)
        var data12 = [
            {pici: "99", kuc: "2", yxTime: "2019.12.31"},
            {pici: "1", kuc: "3", yxTime: "2019.12.31"},
            {pici: "22", kuc: "55", yxTime: "2019.12.31"},
            {pici: "222", kuc: "66", yxTime: "2019.12.31"}
        ]
        var tabNone = new TableInit({
            dom: '#kcdq-table1',
            data: data12,
            method: false,
            type: 'client',
            url: false,
            columns: winObj.shopKuCunAll
        });
        tabNone.Init();
    }

    /**
     * 出库记录二级tab切换
     * */
    $(".ckReload li").click(function () {
        $(this).addClass('active').siblings().removeClass('active');
        $(".tab-items").hide().eq($(this).index()).show();
        if ($(this).index() == 1) {
            getTuiHuoReload();
        } else if ($(this).index() == 2) {
            getXiaoHuiReload();
        } else if ($(this).index() == 0) {
            getXiaoShouReload();
        }
    });
    //初始化
    var TableInit = function (tabObj) {
        var oTableInit = new Object();
        //初始化Table
        oTableInit.Init = function () {
            $(tabObj.dom).bootstrapTable('destroy');
            $(tabObj.dom).bootstrapTable({
                url: tabObj.url,         //请求后台的URL（*）
                method: tabObj.method,                      //请求方式（*）
                data: tabObj.data,
                toolbar: '#toolbar',                //工具按钮用哪个容器
                //                    striped: true,                      //是否显示行间隔色
                cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                pagination: true,                   //是否显示分页（*）
                sortable: false,                     //是否启用排序
                sortOrder: "asc",                   //排序方式
                sidePagination: tabObj.type,           //分页方式：client客户端分页，server服务端分页（*）
                pageNumber: 1,                       //初始化加载第一页，默认第一页
                pageSize: 10,                       //每页的记录行数（*）
                pageList: [10, 20, 30],        //可供选择的每页的行数（*）
                //                search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大
                strictSearch: true,
                showColumns: true,                  //是否显示所有的列
                //              showRefresh: true,                  //是否显示刷新按钮
                minimumCountColumns: 2,             //最少允许的列数
                clickToSelect: true,                //是否启用点击选中行
                //              height: 500,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
                uniqueId: "id",                     //每一行的唯一标识，一般为主键列
                //                showToggle:true,                    //是否显示详细视图和列表视图的切换按钮
                cardView: false,                    //是否显示详细视图
                detailView: false,                   //是否显示父子表
                columns: tabObj.columns,
                //                    showFooter:true,            //表格底部
                onClickRow: function (row) {
                },
                queryParamsType: 'limit',
                queryParams: function (params) {
                    params.token = quakooUser.getUserInfo().token;
                    params.page = (params.offset / params.limit) + 1;
                    params.size = params.limit;
                    // if (startTime) {
                    //     params.ctime = startTime;
                    // }
                    // if (endTime) {
                    //     params.utime = endTime;
                    // }
                    return typeof tabObj.callBack == 'function' ? tabObj.callBack(params) : false;
                },
                onCheckAll: tabObj.onCheckAll,
                onUncheckAll: tabObj.onUncheckAll,
                onCheck: tabObj.onCheck,
                onUncheck: tabObj.onUncheck,
            });
        };
        return oTableInit;
    };

    // 未补充说明产品
    function warnSP() {
        $("#table1").hide();
        $(".warn1").hide();
        $("#table2").show();
        /*所有商品(需要补充说明商品)*/
        //企业证件有效期到期列表
        // var tabThree = new TableInit({ //分页请求
        //     dom: '#xsjl-table1',
        //     data: false,
        //     method: 'get',
        //     type: 'server',
        //     url: config.getUrl_medicalAppliances_getNotBuCSMShop(),
        //     columns: winObj.warnSPList,
        //     callBack: function (row) {
        //         subid: quakooUser.getUserInfo().sid;
        //         token: quakooUser.getUserInfo().token;
        //         return row
        //     }
        // });
        // tabThree.Init();
        quakooData.ajaxGetData(config.getUrl_medicalAppliances_getNotBuCSMShop(), {
            subid: quakooUser.getUserInfo().sid,
            token: quakooUser.getUserInfo().token
        }, function (ret) {
            console.log(ret)
            var tabTwo = new TableInit({
                dom: '#xsjl-table1',
                data: ret.rows,
                method: false,
                type: 'client',
                url: false,
                columns: winObj.warnSPList
            });
            tabTwo.Init();
        })
    }

    function tabListFooter(num, ids) {
        var botBar = '<div class="winFooterBox">' +
            '<span id="numLen"> 选中' + num + '项</span>' +
            '<div class="winFooterLast">' +
            '<span class="btnSubmission">取消选中</span>' +
            '<span class="btnPreservation">审核通过</span>' +
            '</div>' +
            '</div>';
        if (num > 0) {
            $('.qiyeListToast .layui-layer-btn').html(botBar)
            //取消选中
            $('.btnSubmission').click(function () {
                $('#qyxx-table').find('tr.selected input').removeAttr('checked')
                $('#qyxx-table').find('tr.selected').removeClass('selected')
                $('.qiyeListToast .layui-layer-btn').html('<a class="layui-layer-btn0">关闭窗口</a>')
            })
            //审核通过
            $('.btnPreservation').click(function () {
                var idss = [];
                //转换成数组
                Object.keys(ids).forEach(function (key) {
                    idss.push(key)
                });
                console.log(idss)
                quakooData.ajaxGetData(config.getUrl_medicalAppliances_sHeTongGuo(), {ids: idss}, function (ret) {
                    if (ret && ret.success) {
                        layer.msg('审核成功')
                    }
                })
            })
        } else {
            $('.qiyeListToast .layui-layer-btn').html('<a class="layui-layer-btn0">关闭窗口</a>')
            $('.qiyeListToast .layui-layer-btn .layui-layer-btn0').click(function () {
                layer.close(qyToast)
            })
        }
    }

    // 企业列表
    function proLists() {
        var arrOnly = {};
        var qyToast = layer.open({
            type: 1, shade: 0.01,
            title: null,
            skin: 'my-skin qiyeListToast',
            area: ['820px', '550px'],
            anim: 0,
            maxWidth: '720',
            closeBtn: 0, //显示关闭按钮
            resize: false,
            shadeClose: true, //开启遮罩关闭
            content: $('.content-view-proLists'),
            btn: '关闭窗口',
            success: function () {

            }
        });
        //获取所有供应商/生产商列表
        var tabOne = new TableInit({
            dom: '#qyxx-table',
            data: false,
            method: 'get',
            type: 'server',
            url: config.getUrl_medicalAppliances_getgyshang(),
            columns: winObj.gsListAll,
            onCheckAll: function (data) {
                arrOnly = {};
                var len = data.length;
                for (var i = 0; i < data.length; i++) {
                    arrOnly[data[i].id] = data[i].id
                }
                tabListFooter(len, arrOnly)
            },
            onUncheckAll: function (data) {
                var arrAll = {};
                tabListFooter(0, arrAll)
            },
            onCheck: function (data) {
                var len = $('#qyxx-table').find('tr.selected').length;
                arrOnly[data.id] = data.id
                tabListFooter(len, arrOnly)
            },
            onUncheck: function (data) {
                delete arrOnly[data.id]
                var len = $('#qyxx-table').find('tr.selected').length;
                tabListFooter(len, arrOnly)
            },
            callBack: function (row) {
                token: quakooUser.getUserInfo().token;
                return row
            }
        });
        tabOne.Init();

        //获取证件有效期到期企业数量
        quakooData.ajaxGetData(config.getUrl_medicalAppliances_getguoqiGshang(), {token: quakooUser.getUserInfo().token}, function (ret) {
            $('.daoqiWarn .warnLeft').find('.daoNum').html(ret.rows.length);
        })
    }

    // 证件有效期到期弹窗
    function cardGuoqi() {
        //企业证件有效期到期列表
        var tabThree = new TableInit({
            dom: '#zjdq-table',
            data: false,
            method: 'get',
            type: 'server',
            url: config.getUrl_medicalAppliances_getguoqiGshang(),
            columns: winObj.gsGuoqiAll,
            callBack: function (row) {
                token: quakooUser.getUserInfo().token;
                return row
            }
        });
        tabThree.Init();
        layer.open({
            type: 1,
            shade: 0.01,
            title: ['<div style="float: left;font-size: 13px;">证件有效期到期企业</div>', 'background-color: #fff;'],
            skin: 'my-skin',
            area: ['720px', '550px'],
            anim: 0,
            maxWidth: '720',
            closeBtn: 0, //显示关闭按钮
            resize: false,
            shadeClose: true, //开启遮罩关闭
            content: $('.content-view-cardGuoqi'),
            btn: '关闭窗口'
        });
    }


    //创建企业弹窗
    var date1,
        date2,
        date3,
        date4,
        rangeValue = [],
        shopInfo = {};

    function addPros(data) {
        console.log(data)
        if (data) {
            rangeValue.push(data.range);
            shopInfo.area = data.area;
            shopInfo.city = data.city;
            shopInfo.province = data.province;
        } else {
            data.area = 1;
            data.city = 0;
            data.province = 0;
        }
        var index = layer.open({
            type: 1,
            shade: 0.01,
            title: data ? '编辑企业' : '新增企业',
            skin: 'content-view-shopDes-tan content-view-submit', //样式类名
            anim: 0,
            area: ['360px', '550px'],
            closeBtn: 0, //不显示关闭按钮
            resize: false,
            shadeClose: true, //开启遮罩关闭
            content: $('#shopDom'), //容器对象
            btn: ['取消', '保存'],
            yes: function (index) {
                layer.close(index);
            },
            btn2: function (index) {
                addSuppliers(index, data ? data.id : false);
                return false
            },
            success: function (layero, index) {

                if (areaJson.getAreaByAid(data.province)) {
                    data.provinceName = areaJson.getAreaByAid(data.province).name
                }
                if (areaJson.getAreaByAid(data.city)) {
                    data.cityName = areaJson.getAreaByAid(data.city).name
                }
                if (areaJson.getAreaByAid(data.area)) {
                    data.areaName = areaJson.getAreaByAid(data.area).name
                }
                var twoArea = areaJson.getSubList(data.province);
                var threeArea = areaJson.getSubList(data.city);
                $("#shopDom").html(template('shopTmp', {
                    list: data,
                    oneArea: oneArea,
                    twoArea: twoArea,
                    threeArea: threeArea
                }));

                //选择省市区
                selectTag($("#province"), function (ret) {
                    shopInfo.province = ret.value;
                    data.city = '';
                    data.area = '';
                    var areaInfo = areaJson.getSubList(ret.value);
                    $("#city").html(template('selectTagTmp', {list: areaInfo, title: '选择市'}));
                    $("#area").html('')
                    selectTag($("#city"), function (ret1) {
                        shopInfo.city = ret1.value;
                        data.area = '';
                        var area = areaJson.getSubList(ret1.value);
                        $("#area").html(template('selectTagTmp', {list: area, title: '选择区/县'}))
                        selectTag($("#area"), function (ret2) {
                            shopInfo.area = ret2.value;
                        })
                    })
                });
                selectTag($("#city"), function (ret1) {
                    data.city = ret1.value;
                    data.area = '';
                    var area = areaJson.getSubList(ret1.value);
                    $("#area").html(template('selectTagTmp', {list: area, title: '选择区/县'}))
                    selectTag($("#area"), function (ret2) {
                        data.area = ret2.value;
                    })
                });
                selectTag($("#area"), function (ret2) {
                    data.area = ret2.value;
                });

                //日期范围插件开始
                date1 = new dateRange(".yj-demo-time");
                date2 = new dateRange("#time02 .yj-demo-time");
                date3 = new dateRange("#time03 .yj-demo-time");
                date4 = new dateRange("#time04 .yj-demo-time");
                date1.init();
                date2.init();
                date3.init();
                date4.init();
                if (data) {
                    if (data.comBusinessDateStart) {
                        date1.checkStart = quakooUtils.formatTimeToDateDianLY(data.comBusinessDateStart);
                        date1.checkEnd = quakooUtils.formatTimeToDateDianLY(data.comBusinessDateEnd);
                    }
                    if (data.mfRegisterDateStart) {
                        date2.checkStart = quakooUtils.formatTimeToDateDianLY(data.mfRegisterDateStart);
                        date2.checkEnd = quakooUtils.formatTimeToDateDianLY(data.mfRegisterDateEnd);
                    }
                    if (data.licenceDateStart) {
                        date3.checkStart = quakooUtils.formatTimeToDateDianLY(data.licenceDateStart);
                        date3.checkEnd = quakooUtils.formatTimeToDateDianLY(data.licenceDateEnd);
                    }
                    if (data.proDateStart) {
                        date4.checkStart = quakooUtils.formatTimeToDateDianLY(data.proDateStart);
                        date4.checkEnd = quakooUtils.formatTimeToDateDianLY(data.proDateEnd);
                    }
                }
                //日期范围插件结束

                //获取经营范围
                quakooData.ajaxGetData(config.getUrl_medicalAppliances_getRange(), {token: quakooUser.getUserInfo().token}, function (ret) {
                    var html = template('option2', {list: ret.data});
                    $('#option1').html(html)
                    //选择经营范围
                    selectTag($("#select1"), function (ret) {
                        rangeValue.push(ret.text);
                    })
                })

                //营业时间
                var opt = {};
                opt.date = {preset: 'date'};
                opt.datetime = {preset: 'datetime'};
                opt.time = {preset: 'time'};

                opt.default = {
                    theme: 'mbsc-android-holo', //皮肤样式
                    display: 'bubble', //显示方式
                    mode: 'scroller', //日期选择模式
                    dateFormat: 'yyyy-mm-dd',
                    lang: 'zh',
                    showNow: true,
                    nowText: "今天",
                    typeNum: 'day',//day：获取到日，time：获取到时，branch：获取到分；默认是获取到分
                };
                $('.settings').bind('change', function () {
                    var demo = 'datetime';
                    if (!demo.match(/select/i)) {
                        if (data) return;
                        $('.demo-test-' + demo).val('');
                    }
                    $('.demo-test-' + demo).scroller('destroy').scroller($.extend(opt['datetime'], opt['default']));
                    $('.demo').hide();
                    $('.demo-' + demo).show();
                });


                $('#demo01').trigger('change');
                $('#demo03').trigger('change');
                $('#demo05').trigger('change');
                $('#demo07').trigger('change');
            }
        });
    }

    function delImg(self) {
        $(self).parent('.imgBox').remove()
        if ($('.imgBox .imgBox').length < 9) {
            $(".test2").show();
        }
    }

    //上传门店图片
    function uploadIcon(self) {
        $('#uploadForm>input').val('');
        quakooImg.open(function (data) {
            for (var i = 0; i < data.length; i++) {
                if ($(self).prevAll('.imgBox').length < 9) {
                    var obj = quakooImg.processImg(data[i], 100, 100)
                    var str = '<div class="imgBox"><img src="' + obj.url + '" real-src="' + data[i] + '" style="' + obj.style + '" alt=""><div class="del" onclick="delImg(this)"></div></div>'
                    $(self).before(str)
                }
            }
            if ($(self).prevAll('.imgBox').length >= 9) {
                $(self).hide();
            }
        })
    }

    //新增企业
    function addSuppliers(index, id) {
        var param = {};
        if (id) param.id = id;
        param.name = $("#qysname").val(); //企业名称
        param.userName = $("#lxsname").val(); // 联系人
        param.phone = $("#lxphone").val(); //联系电话
        param.range = rangeValue.join(','); //经营范围
        console.log(param.range)
        var storeImg = $.makeArray($('#yyImg .imgBox>img').map(function (index, item) {
            return $(item).attr('real-src');
        })); //企业营业执照照片
        param.storeImg = storeImg.join(',')
        console.log(param.storeImg)
        param.comBusinessNum = $("#yybh").val(); //企业营业执照编号

        param.comBusinessDate = quakooUtils.isNotBlack($("#startTime1").val()) ? new Date($("#startTime1").val()).getTime() : ''; //企业营业执照发证日期

        param.comBusinessDateEnd = quakooUtils.isNotBlack(date1.checkStart) ? date3.getTime()[3] : ''; //企业营业执照有效日期结束时间
        param.comBusinessDateStart = quakooUtils.isNotBlack(date1.checkEnd) ? date3.getTime()[2] : ''; //企业营业执照有效日期开始时间
        param.mfNum = $("#ylnum").val() ? $("#ylnum").val() : ''; //医疗器械注册证编号
        param.mfRegisterDate = quakooUtils.isNotBlack($("#startTime2").val()) ? new Date($("#startTime2").val()).getTime() : ''; //医疗器械注册证批准日期
        param.mfRegisterDateEnd = quakooUtils.isNotBlack(date2.checkStart) ? date2.getTime()[3] : ''; //医疗器械注册证有效日期结束时间
        param.mfRegisterDateStart = quakooUtils.isNotBlack(date2.checkEnd) ? date2.getTime()[2] : ''; //医疗器械注册证有效日期开始时间
        var mfRegisterImg = $.makeArray($('#ylImg .imgBox>img').map(function (index, item) {
            return $(item).attr('real-src');
        })); //医疗器械注册证照片
        // param.mfRegisterImg = JSON.stringify(mfRegisterImg)
        param.mfRegisterImg = mfRegisterImg.join(',');
        param.licenceNum = $("#scykCard").val(); //生产许可证编号
        param.licenceDate = quakooUtils.isNotBlack($("#startTime3").val()) ? new Date($("#startTime3").val()).getTime() : ''; //生产许可证发证日期
        param.licenceDateEnd = quakooUtils.isNotBlack(date3.checkStart) ? date3.getTime()[3] : ''; //生产许可证有效日期结束时间
        param.licenceDateStart = quakooUtils.isNotBlack(date3.checkEnd) ? date3.getTime()[2] : ''; //生产许可证有效日期开始时间
        var licenceImg = $.makeArray($('#scImg .imgBox>img').map(function (index, item) {
            return $(item).attr('real-src');
        })); //生产许可证照片
        // param.licenceImg = JSON.stringify(licenceImg)
        param.licenceImg = licenceImg.join(',')
        var licenceDescImg = $.makeArray($('#qtImg .imgBox>img').map(function (index, item) {
            return $(item).attr('real-src');
        })); //生产许可证其他资料照片
        // param.licenceDescImg = JSON.stringify(licenceDescImg)
        param.licenceDescImg = licenceDescImg.join(',')
        param.proNum = $("#ylxkz").val(); //医疗器械经营许可证
        param.proDate = quakooUtils.isNotBlack($("#startTime4").val()) ? new Date($("#startTime4").val()).getTime() : ''; //供应商经营许可证批准日期
        param.proDateEnd = quakooUtils.isNotBlack(date4.checkStart) ? date4.getTime()[3] : ''; //供应商经营许可证有效日期结束时间
        param.proDateStart = quakooUtils.isNotBlack(date4.checkEnd) ? date4.getTime()[2] : ''; //供应商经营许可证有效日期开始时间
        param.proImg = $.makeArray($('#ylxkzimg .imgBox>img').map(function (index, item) {
            return $(item).attr('real-src');
        })).join(','); //经营许可证照片
        // param.proImg = JSON.stringify(proImg)
        var proDescImg = $.makeArray($('#qtzlImg .imgBox>img').map(function (index, item) {
            return $(item).attr('real-src');
        })); //经营许可证其他资料照片
        // param.proDescImg = JSON.stringify(proDescImg)
        param.proDescImg = proDescImg.join(',')
        param.province = shopInfo.province;//省
        param.city = shopInfo.city;//市
        param.area = shopInfo.area;//区
        param.address = $('#address').val(); //选择详细地址
        console.log(param);
        if ($('#shcheck1').is(':checked') === true) {
            param.manufacturerProvider = ['1'].join(','); //生产商/供应商 1//生产商；2//供应商
            if (quakooUtils.isBlack(param.mfNum)) {
                layer.msg('医疗器械注册证编号');
                return;
            }
            if (quakooUtils.isBlack(param.mfRegisterDate)) {
                layer.msg('医疗器械注册证批准日期');
                return;
            }
            if (quakooUtils.isBlack(param.mfRegisterDateEnd)) {
                layer.msg('医疗器械注册证有效日期结束时间');
                return;
            }
            if (quakooUtils.isBlack(param.mfRegisterDateStart)) {
                layer.msg('医疗器械注册证有效日期开始时间');
                return;
            }
            if (quakooUtils.isBlack(param.mfRegisterImg)) {
                layer.msg('医疗器械注册证照片');
                return;
            }
            if (quakooUtils.isBlack(param.licenceNum)) {
                layer.msg('生产许可证编号');
                return;
            }
            if (quakooUtils.isBlack(param.licenceDate)) {
                layer.msg('生产许可证发证日期');
                return;
            }
            if (quakooUtils.isBlack(param.licenceDateEnd)) {
                layer.msg('生产许可证有效日期结束时间');
                return;
            }
            if (quakooUtils.isBlack(param.licenceDateStart)) {
                layer.msg('生产许可证有效日期开始时间');
                return;
            }
            if (quakooUtils.isBlack(param.licenceImg)) {
                layer.msg('生产许可证照片');
                return;
            }
            if (quakooUtils.isBlack(param.licenceDescImg)) {
                layer.msg('生产许可证其他资料照片');
                return;
            }
        }

        if ($('#shcheck2').is(':checked') === true) {
            param.manufacturerProvider = ['2'].join(','); //生产商/供应商 1//生产商；2//供应商
            if (quakooUtils.isBlack(param.proNum)) {
                layer.msg('医疗器械经营许可证');
                return;
            }
            if (quakooUtils.isBlack(param.proDate)) {
                layer.msg('供应商经营许可证批准日期');
                return;
            }
            if (quakooUtils.isBlack(param.proDateEnd)) {
                layer.msg('供应商经营许可证有效日期结束时间');
                return;
            }
            if (quakooUtils.isBlack(param.proDateStart)) {
                layer.msg('供应商经营许可证有效日期开始时间');
                return;
            }
            if (quakooUtils.isBlack(param.proImg)) {
                layer.msg('经营许可证照片');
                return;
            }
            if (quakooUtils.isBlack(param.proDescImg)) {
                layer.msg('经营许可证其他资料照片');
                return;
            }
        }

        if ($('#shcheck1').is(':checked') === true && $('#shcheck2').is(':checked') === true) {
            param.manufacturerProvider = ['1', '2'].join(','); //生产商/供应商 1//生产商；2//供应商
        } else {
            param.manufacturerProvider = null; //生产商/供应商 1//生产商；2//供应商
        }
        if (quakooUtils.isBlack(param.name)) {
            layer.msg('企业名称');
            return;
        }
        if (quakooUtils.isBlack(param.userName)) {
            layer.msg('联系人');
            return;
        }
        if (quakooUtils.isBlack(param.phone)) {
            layer.msg('联系电话');
            return;
        }
        if (quakooUtils.isBlack(param.range)) {
            layer.msg('经营范围');
            return;
        }
        if (quakooUtils.isBlack(param.province) || quakooUtils.isBlack(param.city) || quakooUtils.isBlack(param.area)) {
            layer.msg('请选择地址');
            return;
        }
        if (quakooUtils.isBlack(param.address)) {
            layer.msg('请输入详细地址');
            return;
        }
        if (quakooUtils.isBlack(param.storeImg)) {
            layer.msg('企业营业执照照片');
            return;
        }
        if (quakooUtils.isBlack(param.comBusinessNum)) {
            layer.msg('企业营业执照编号');
            return;
        }
        if (quakooUtils.isBlack(param.comBusinessDate)) {
            layer.msg('企业营业执照发证日期');
            return;
        }
        if (quakooUtils.isBlack(param.comBusinessDateEnd)) {
            layer.msg('企业营业执照有效日期结束时间');
            return;
        }
        if (quakooUtils.isBlack(param.comBusinessDateStart)) {
            layer.msg('企业营业执照有效日期开始时间');
            return;
        }
        var url = id ? config.getUrl_medicalAppliances_update() : config.getUrl_medicalAppliances_addgyshang();

        quakooData.ajaxGetData(url, param, function (ret) {
            if (ret.success) {
                layer.msg("保存成功");
                $('#qyxx-table').bootstrapTable('refreshOptions', {
                    pageNumber: 1
                });
                layer.close(index);
            } else {
                layer.msg(ret.data);
            }
        })
    }

    function shows1(_this) {
        $('.qyshow1').slideToggle();
    }

    function shows2(_this) {
        $('.qyshow2').slideToggle();
    }
</script>
</body>

</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="renderer" content="webkit">
    <title>统计数据</title>
    <link href="../resource/css/yanjing/mobiscroll.2.13.2.css" rel="stylesheet">
    <link href="../resource/layui/css/layui.css" rel="stylesheet">
    <link href="../resource/css/bootstrap.min.css" rel="stylesheet">
    <link href="../resource/css/reset.css" rel="stylesheet">
    <link href="../resource/js/plugins/bootstarp-table/css/bootstrap-table.min.css" rel="stylesheet">
    <link href="../resource/css/plugins/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css" rel="stylesheet">
    <link href="../resource/css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="../resource/css/animate.css" rel="stylesheet">
    <link href="../resource/css/style.css" rel="stylesheet">
    <link href="../resource/css/common.css" rel="stylesheet">
    <link href="../resource/css/yanjing/myDate.css" rel="stylesheet">
    <link rel="stylesheet" href="../resource/fonts/iconfont.css">
    <link rel="stylesheet" href="../resource/css/common.css">
    <link rel="stylesheet" href="../resource/css/yanjing/goodsManage.css">
    <link rel="stylesheet" href="../resource/css/yanjing/chuku.css">
    <link rel="stylesheet" href="../resource/css/yanjing/statistics.css">

</head>
<body>
    <div class="yj-header">
        <div class="yj-header-left">
            <div>
                <i class="iconfont icon-ico_stock_out_filled"></i>
            </div>
            商品入库
        </div>
        <div class="yj-header-right">
            <button class="btn btn-primary" onclick="addRepertory()">新增入库</button>
        </div>
    </div>
    <div class="goods-header">
        <div class="selectBox" >
            <div class="yj-header-time" id="select-date">
                <div class="yj-date">
                    <span>开始时间-结束时间</span><i class="iconfont icon-ico_calendar"></i>
                </div>
            </div>
        </div>
        <div class="selectBox" id="select-type">

        </div>
    </div>
    <div class="goods-body">
        <ul class="contUl" id="showUl">
            <!--<li class="item">
                <div class="head">
                    <span class="mainCont-head-left red"><em></em>常规出库</span>
                    <span>发起人:<em>总仓</em></span>
                </div>
                <div class="body">
                    <div class="top">
                        <ul>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X10</span>
                            </li>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X20</span>
                            </li>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X200</span>
                            </li>
                            <li>
                                <span class="txtOverflow">商品A</span>
                                <span>-20</span>
                            </li>
                            <li style="color:#828297">
                                ...
                            </li>
                        </ul>
                    </div>
                    <div class="bottom">
                        <div>共15种商品</div>
                        <div>数量总计:100</div>
                    </div>
                </div>
                <div class="foot">
                    <span class="txt">2018.01.21<em>18:49:57</em></span>
                    <button class="btn btn-danger">等待确认</button>
                </div>
            </li>
            <li class="item">
                <div class="head">
                    <span class="mainCont-head-left blue"><em></em>常规出库</span>
                    <span>发起人:<em>总仓</em></span>
                </div>
                <div class="body">
                    <div class="top">
                        <ul>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X10</span>
                            </li>
                            <li>
                                <span class="txtOverflow">商品A</span>
                                <span>-20</span>
                            </li>
                            <li>
                                <span class="txtOverflow">商品B</span>
                                <span>+9</span>
                            </li>
                        </ul>
                    </div>
                    <div class="bottom">
                        <div>共3种商品</div>
                        <div>数量总计:100</div>
                    </div>
                </div>
                <div class="foot">
                    <span class="txt">2018.01.21<em>18:49:57</em></span>
                    <button class="btn btn-primary">编辑</button>
                </div>
            </li>
            <li class="item">
                <div class="head">
                    <span class="mainCont-head-left blue"><em></em>常规出库</span>
                    <span>发起人:<em>总仓</em></span>
                </div>
                <div class="body">
                    <div class="top">
                        <ul>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X10</span>
                            </li>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X20</span>
                            </li>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X200</span>
                            </li>
                            <li>
                                <span class="txtOverflow">商品A</span>
                                <span>-20</span>
                            </li>
                            <li>
                                <span class="txtOverflow">商品B</span>
                                <span>+9</span>
                            </li>
                        </ul>
                    </div>
                    <div class="bottom">
                        <div>共5种商品</div>
                        <div>数量总计:100</div>
                    </div>
                </div>
                <div class="foot">
                    <span class="txt">2018.01.21<em>18:49:57</em></span>
                    <button class="btn btn-primary">编辑</button>
                </div>
            </li>
            <li class="item">
                <div class="head">
                    <span class="mainCont-head-left purple"><em></em>订单出库</span>
                    <span>发起人:<em>总仓</em></span>
                </div>
                <div class="body">
                    <div class="top">
                        <ul>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X10</span>
                            </li>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X20</span>
                            </li>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X200</span>
                            </li>
                            <li>
                                <span class="txtOverflow">商品A</span>
                                <span>-20</span>
                            </li>
                            <li>
                                <span class="txtOverflow">商品B</span>
                                <span>+9</span>
                            </li>
                        </ul>
                    </div>
                    <div class="bottom">
                        <div>共15种商品</div>
                        <div>数量总计:100</div>
                    </div>
                </div>
                <div class="foot">
                    <span class="txt">2018.01.21<em>18:49:57</em></span>
                    <button class="btn btn-order">查看</button>
                </div>
            </li>
            <li class="item">
                <div class="head">
                    <span class="mainCont-head-left red"><em></em>调货出库</span>
                    <span>发起人:<em>总仓</em></span>
                </div>
                <div class="body">
                    <div class="top">
                        <ul>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X10</span>
                            </li>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X20</span>
                            </li>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X200</span>
                            </li>
                            <li>
                                <span class="txtOverflow">商品A</span>
                                <span>-20</span>
                            </li>
                            <li>
                                <span class="txtOverflow">商品B</span>
                                <span>+9</span>
                            </li>
                        </ul>
                    </div>
                    <div class="bottom">
                        <div>共15种商品</div>
                        <div>数量总计:100</div>
                    </div>
                </div>
                <div class="foot">
                    <span class="txt">2018.01.21<em>18:49:57</em></span>
                    <button class="btn btn-order">查看</button>
                </div>
            </li>
            <li class="item">
                <div class="head">
                    <span class="mainCont-head-left blue"><em></em>常规出库</span>
                    <span>发起人:<em>总仓</em></span>
                </div>
                <div class="body">
                    <div class="top">
                        <ul>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X10</span>
                            </li>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X20</span>
                            </li>
                            <li>
                                <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                                <span>X200</span>
                            </li>
                            <li>
                                <span class="txtOverflow">商品A</span>
                                <span>-20</span>
                            </li>
                            <li>
                                <span class="txtOverflow">商品B</span>
                                <span>+9</span>
                            </li>
                        </ul>
                    </div>
                    <div class="bottom">
                        <div>共5种商品</div>
                        <div>数量总计:100</div>
                    </div>
                </div>
                <div class="foot">
                    <span class="txt">2018.01.21<em>18:49:57</em></span>
                    <button class="btn btn-order">查看</button>
                </div>
            </li>-->
        </ul>
        <table id="yj-table" data-toggle="table" class="table table-border"></table>
    </div>
<!--新增入库弹窗-->
<div class="content-view content-view-enter clearfix" id="addDom">
    <!--<div class="leftBox leftBoxTitle">
        <div class="head">
            <span class="title">添加商品</span>
            <div class="check_box">
                <input type="checkbox" name="condition" id="out-ckType" >
                <label for="out-ckType">赠单入库</label>
            </div>
        </div>
    </div>
    <div class="rightBox leftBoxTitle">
        <div class="head">
            <span class="title">入库单</span>
            <div class="selectBox" id="out-people">
                <div class="select-box-header">
                    <span class="text">入库人</span> <i class="iconfont icon-ico_arrow_down"></i>
                </div>
                <div class="optionBox">
                    <ul class="optionUL">
                        <%for(var i=0;i< peopleData.length;i++){%>
                        <li value="<%=peopleData[i].id%>"><%=peopleData[i].name%></li>
                        <%}%>
                    </ul>
                </div>
            </div>
            <span class="person">入库人:</span>
        </div>
    </div>-->


</div>
<!--查看不可入库弹窗-->
<div class="content-view content-view-checkRepertory">
    <div class="body">
        <!--带滚动-->
        <div class="itemDiv _scroll">
            <p class="name">眼镜</p>
            <div class="box">
                <div class="thead">
                    <span>名称</span>
                    <span>球镜度数</span>
                    <span>散光度数</span>
                    <span>数量</span>
                    <span>保质期</span>
                    <span>生产批号</span>
                </div>
                <ul class="tbody">
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span class="line16">20180402<br/>20190806
            </span>
                        <span>色号A</span>
                        <span>8</span>
                        <span>5449685</span>
                    </li>
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span class="line16">20180402<br/>20190806
            </span>
                        <span>色号A</span>
                        <span>8</span>
                        <span>5449685</span>
                    </li>
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span class="line16">20180402<br/>20190806
            </span>
                        <span>色号A</span>
                        <span>8</span>
                        <span>5449685</span>
                    </li>
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span class="line16">20180402<br/>20190806
            </span>
                        <span>色号A</span>
                        <span>8</span>
                        <span>5449685</span>
                    </li>
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span class="line16">20180402<br/>20190806
            </span>
                        <span>色号A</span>
                        <span>8</span>
                        <span>5449685</span>
                    </li>
                </ul>
            </div>
        </div>
        <!--不带滚动-->
        <div class="itemDiv">
            <p class="name">眼镜</p>
            <div class="box">
                <div class="thead">
                    <span>名称</span>
                    <span>球镜度数</span>
                    <span>散光度数</span>
                    <span>数量</span>
                </div>
                <ul class="tbody">
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span>色号A</span>
                        <span>8</span>
                    </li>
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span>色号A</span>
                        <span>8</span>
                    </li>
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span>色号A</span>
                        <span>8</span>
                    </li>
                </ul>
            </div>
        </div>
        <div class="itemDiv">
            <p class="name">眼镜</p>
            <div class="box">
                <div class="thead">
                    <span>名称</span>
                    <span>球镜度数</span>
                    <span>散光度数</span>
                    <span>数量</span>
                </div>
                <ul class="tbody">
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span>色号A</span>
                        <span>8</span>
                    </li>
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span>色号A</span>
                        <span>8</span>
                    </li>
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span>色号A</span>
                        <span>8</span>
                    </li>
                </ul>
            </div>
        </div>
        <div class="itemDiv">
            <p class="name">眼镜</p>
            <div class="box">
                <div class="thead">
                    <span>名称</span>
                    <span>球镜度数</span>
                    <span>散光度数</span>
                    <span>数量</span>
                </div>
                <ul class="tbody">
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span>色号A</span>
                        <span>8</span>
                    </li>
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span>色号A</span>
                        <span>8</span>
                    </li>
                    <li>
                        <span>名称A</span>
                        <span>型号A</span>
                        <span>色号A</span>
                        <span>8</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="foot">
        <span class="_btn layui-layer-btn0">关闭窗口</span>
        <span class="_btn _bgColor01">打印入库单</span>
        <span class="_btn _bgColor02">打印条码</span>
    </div>
</div>
<!--选择多家门店弹窗-->
<div class="content-view content-view-selectShop">
    <ul>

    </ul>
</div>
<!--全局js-->
<script src="../resource/js/jquery.min.js"></script>
<script src="../resource/js/bootstrap.js?v=3.3.6"></script>
<!--时间插件引用的css-->
<script src="../resource/js/plugins/bootstarp-table/js/bootstrap-table.js"></script>
<script src="../resource/js/plugins/bootstarp-table/js/bootstrap-table-zh-CN.min.js"></script>
<script src="../resource/js/plugins/layer/layer.js"></script>
<script src="../resource/layui/layui.js"></script>

<script src="../resource/js/lib/quakooLib/QuakooBase-1.0.0.js"></script>
<script src="../resource/js/lib/quakooLib/QuakooConfig-1.0.0.js"></script>
<script src="../resource/js/lib/quakooLib/QuakooBasePc-1.0.0.js"></script>
<script src="../resource/js/lib/quakoo/Config.js"></script>
<script src="../resource/js/lib/quakoo/project.js"></script>
<script src="../resource/common/common.js?" +Math.random()></script>
<script src="../resource/js/template-native.js"></script>
<script src="../resource/js/yanjing.js"></script>
<!--//日期范围插件开始-->
<script src="../resource/js/yanjing/daterange.js"></script>
<script type="text/html" id="dataTmp">
    <%for(var i=0;i< list.length;i++){%>
    <li class="item">
        <div class="head">
            <span class="mainCont-head-left red"><em></em>常规出库</span>
            <span>发起人:<em>总仓</em></span>
        </div>
        <div class="body">
            <div class="top">
                <ul>
                    <li>
                        <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                        <span>X10</span>
                    </li>
                    <li>
                        <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                        <span>X20</span>
                    </li>
                    <li>
                        <span class="txtOverflow">HYDRON海昌透明黑色单片年抛</span>
                        <span>X200</span>
                    </li>
                    <li>
                        <span class="txtOverflow">商品A</span>
                        <span>-20</span>
                    </li>
                    <li style="color:#828297">
                        ...
                    </li>
                </ul>
            </div>
            <div class="bottom">
                <div>共15种商品</div>
                <div>数量总计:100</div>
            </div>
        </div>
        <div class="foot">
            <span class="txt">2018.01.21<em>18:49:57</em></span>
            <button class="btn btn-danger">等待确认</button>
        </div>
    </li>
    <%}%>
</script>

<script type="text/html" id="addTmp">
    <div class="leftBox">
        <div class="body">
            <ul class="tab-ul" id="yj-category">
                <%for(var i=0;i< categoryData.length;i++){%>
                <%if(categoryData[i].name!='特殊商品'){%>
                <li id="category<%=categoryData[i].id%>" onclick="chooseGoodsType('<%=categoryData[i].id%>')"><%=categoryData[i].name%></li>
                <%}%>
                <%}%>
            </ul>
            <div class="cont">
                <div class="choiceBox">
                    <div class="box01">
                        <div class="selectBox" id="out-brand">
                            <div class="select-box-header">
                                <span class="text">品牌</span> <i class="iconfont icon-ico_arrow_down"></i>
                            </div>
                            <div class="optionBox" style="display: none;">
                                <ul class="optionUL">
                                    <%for(var i=0;i< brandData.length;i++){%>
                                    <li value="<%=brandData[i].id%>"><%=brandData[i].name%></li>
                                    <%}%>
                                </ul>
                            </div>
                        </div>
                        <div class="selectBox" id="out-series">
                            <div class="select-box-header">
                                <span class="text">系列</span> <i class="iconfont icon-ico_arrow_down"></i>
                            </div>
                            <div class="optionBox" style="display: none;">
                                <ul class="optionUL">

                                </ul>
                            </div>
                        </div>
                        <div class="selectBox" id="out-provider">
                            <div class="select-box-header">
                                <span class="text">供应商</span> <i class="iconfont icon-ico_arrow_down"></i>
                            </div>
                            <div class="optionBox" style="display: none;">
                                <ul class="optionUL">
                                    <%for(var i=0;i< providerData.length;i++){%>
                                    <li value="<%=providerData[i].id%>"><%=providerData[i].name%></li>
                                    <%}%>
                                </ul>
                            </div>
                        </div>
                        <div class="selectBox" id="out-type">
                            <div class="select-box-header">
                                <span class="text">常规商品</span> <i class="iconfont icon-ico_arrow_down"></i>
                            </div>
                            <div class="optionBox" style="display: none;">
                                <ul class="optionUL">
                                    <li value="0">常规商品</li>
                                    <li value="1">积分商品</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="box02">
                        <span>品牌A系列B</span>
                        <div class="btn btn-info fr" onclick="getSpu()">查询</div>
                    </div>
                </div>
                <div class="inputBox clearfix out-box">
                    <div class="selectBox yxyj-box jp-box" id="out-ball" style="min-width: 80px;">
                        <div class="select-box-header">
                            <span class="text">球</span> <i class="iconfont icon-ico_arrow_down"></i>
                        </div>
                        <div class="optionBox" style="display: none;">
                            <ul class="optionUL">
                                <%for(var i=0;i< ballData.length;i++){%>
                                <li value="<%=ballData[i].id%>"><%=ballData[i].content%></li>
                                <%}%>
                            </ul>
                        </div>
                    </div>
                    <div class="selectBox jp-box" id="out-column" style="min-width: 80px;">
                        <div class="select-box-header">
                            <span class="text">柱</span> <i class="iconfont icon-ico_arrow_down"></i>
                        </div>
                        <div class="optionBox" style="display: none;">
                            <ul class="optionUL">
                                <%for(var i=0;i< columnData.length;i++){%>
                                <li value="<%=columnData[i].id%>"><%=columnData[i].content%></li>
                                <%}%>
                            </ul>
                        </div>
                    </div>
                    <input class="yxyj-box hlcp-box" placeholder="生产批号" id="out-shengchanpihao" type="number">
                    <div class="expiryDate yxyj-box hlcp-box">
                        <div class="expiryDate-demo-time" id="out-date">
                            <div class="yj-date">
                                <span>保质期</span><i class="iconfont icon-ico_calendar"></i>
                            </div>
                        </div>
                    </div>
                    <input class="jj-box qtsp-box" placeholder="型号" id="out-xinghao" type="text">
                    <div class="selectBox qtsp-box" id="out-guangdu">
                        <div class="select-box-header">
                            <span class="text">光度</span> <i class="iconfont icon-ico_arrow_down"></i>
                        </div>
                        <div class="optionBox" style="display: none;">
                            <ul class="optionUL">
                                <li value="01">0.25</li>
                                <li value="02">0.25</li>
                                <li value="03">0.25</li>
                                <li value="04">0.25</li>
                                <li value="05">0.25</li>
                            </ul>
                        </div>
                    </div>
                    <input class="jj-box" placeholder="色号" type="text" id="out-sehao">
                    <input class="yxyj-box jj-box hlcp-box qtsp-box jp-box" id="out-num" style="width: 62px;" placeholder="数量" type="number">
                </div>
                <div class="addBtn _btn canAdd" onclick="addToList()">添加至入库单</div>
                <div class="check_box">
                    <input type="checkbox" name="condition" id="condition1" checked="checked">
                    <label for="condition1">简易入库</label>
                </div>
            </div>
            <div class="in-table">
                <table class="table table-self" id="in-table" lay-filter="in-table"></table>
            </div>

        </div>
    </div>
    <!--右边-->
    <div class="rightBox">
        <div class="body" id="outListDom">

        </div>
    </div>
</script>
<!--下拉选择模板带全部-->
    <script type="text/html" id="selectTagTmpAll">
        <div class="select-box-header">
            <span class="text"><%=title%></span> <i class="iconfont icon-ico_arrow_down" ></i>
        </div>
        <div class="optionBox">
            <ul class="optionUL">
                <li value="-1">全部</li>
                <%for(var i=0;i< list.length;i++){%>
                <li value="<%=list[i].id%>" data-pnid="<%if(list[i].pnid){%><%=list[i].pnid%><%}%>"><%if(list[i].name){%><%=list[i].name%><%}else{%><%=list[i].content%><%}%></li>
                <%}%>
            </ul>
        </div>
    </script>
<!--下拉选择模板-->
<script type="text/html" id="selectTagTmp">
    <div class="select-box-header">
        <span class="text"><%=title%></span> <i class="iconfont icon-ico_arrow_down" ></i>
    </div>
    <div class="optionBox">
        <ul class="optionUL">
            <%for(var i=0;i< list.length;i++){%>
            <li value="<%=list[i].id%>" data-pnid="<%if(list[i].pnid){%><%=list[i].pnid%><%}%>"><%if(list[i].name){%><%=list[i].name%><%}else{%><%=list[i].content%><%}%></li>
            <%}%>
        </ul>
    </div>
</script>

<script type="text/html" id="outListTmp">
    <%for(var i in list){%>
    <%if(list[i].data.length>0){%>
    <!--<div class="itemDiv">-->
    <div class="itemDiv _scroll">
        <p class="name"><%=list[i].name%></p>
        <div class="box">
            <div class="thead">
                <span>产品编码</span>
                <span>品牌</span>
                <span>系列</span>
                <span>供应商</span>
                <span>商品类型</span>
                <%if(list[i].name=='镜片'){%>
                <span>球</span>
                <span>柱</span>
                <%}else if(list[i].name=='镜架' || list[i].name=='太阳镜'){%>
                <span>型号</span>
                <span>色号</span>
                <%}else if(list[i].name=='隐形眼镜'){%>
                <span>球镜度数</span>
                <span>生产批号</span>
                <span>保质期</span>
                <%}else if(list[i].name=='护理产品'){%>
                <span>生产批号</span>
                <span>保质期</span>
                <%}else if(list[i].name=='其它商品'){%>
                <span>型号</span>
                <%}%>
                <span>数量</span>
                <span class="removeLi">操作</span>
            </div>
            <ul class="tbody">
                <%for(var j=0;j< list[i].data.length;j++){%>
                <li>
                    <span><%=list[i].data[j].code%></span>
                    <span><%=list[i].data[j].brandName%></span>
                    <span><%=list[i].data[j].seriesName%></span>
                    <span><%=list[i].data[j].providerName%></span>
                    <%if(type==0){%>
                    <span>常规商品</span>
                    <%}else{%>
                    <span>积分商品</span>
                    <%}%>
                    <%if(list[i].name=='镜片'){%>
                    <span><%=list[i].data[j].properties[15]%></span>
                    <span><%=list[i].data[j].properties[16]%></span>
                    <%}else if(list[i].name=='镜架' || list[i].name=='太阳镜'){%>
                    <span><%=list[i].data[j].xinghao%></span>
                    <span><%=list[i].data[j].sehao%></span>
                    <%}else if(list[i].name=='隐形眼镜'){%>
                    <span><%=list[i].data[j].ballName%></span>
                    <span><%=list[i].data[j].shengchanpihao%></span>
                    <span class="line16"><%=list[i].data[j].outDate[0]%><br/><%=list[i].data[j].outDate[1]%></span>
                    <%}else if(list[i].name=='护理产品'){%>
                    <span><%=list[i].data[j].shengchanpihao%></span>
                    <span class="line16"><%=list[i].data[j].outDate[0]%><br/><%=list[i].data[j].outDate[1]%></span>
                    <%}else if(list[i].name=='其它商品'){%>
                    <span><%=list[i].data[j].xinghao%></span>
                    <%}%>
                    <span><%=list[i].data[j].newNum%></span>
                    <span class="remove" onclick="removeOutLi('<%=i%>','<%=j%>')">移除</span>
                </li>
                <%}%>
            </ul>
        </div>
    </div>
    <%}%>
    <%}%>
</script>
<script>
    var subid = quakooUser.getUserInfo().sid;//企业id
    var selectBid;//筛选条件的品牌id
    var categoryData = [];//一级类目数据
    var brandData = [];//品牌数据
    var providerData = [];//供应商数据
    var ballData = [];//球数据
    var columnData = [];//柱数据
    var peopleData = [];//员工数据
    var cid;            //一级类目id
    var allOutList = {};//全部数据
    var ckType = 0;//仓库类型 普通仓库(0) 赠品仓库(1)
    var peopleId;//入库人id

    var bid;//添加入库时的品牌id
    var sid = -1;
    var outDate;
    var pid;
    var type = 0;
    var selectDate = new dateRange("#select-date");
    selectDate.init()
    //获取一级类目
    quakooData.ajaxGetData(config.getUrl_productCategory_getSubAllList(),{subid:subid},function (ret) {
        if(ret && ret.success){
            categoryData = ret.data;
        }
    })
    //获取品牌数据
    quakooData.ajaxGetData(config.getUrl_productBrand_getSubAllList(),{subid:subid},function (ret) {
        if(ret && ret.success){
            brandData = ret.data;
            var html = template('selectTagTmpAll',{title:'全部商品类型',list:ret.data});
            //商品列表的筛选
            $('#select-type').html(html);
            selectTag($("#select-type"),function (data) {
                if(data.value){
                    selectBid = data.value;
                }
            })
        }
    })
    //获取属性-球
    quakooData.ajaxGetData(config.getUrl_productPropertyvalue_getAllList(),{pnid:15},function (ret) {
        if(ret && ret.success){
            ballData = ret.data.sort(function (a,b) {
                return b.content-a.content;
            });
        }
    })
    //获取供应商
    quakooData.ajaxGetData(config.getUrl_productProvider_getSubAllList(),{subid:subid},function (ret) {
        if(ret && ret.success){
            providerData = ret.data;
        }
    })
    //获取属性-柱
    quakooData.ajaxGetData(config.getUrl_productPropertyvalue_getAllList(),{pnid:16},function (ret) {
        if(ret && ret.success){
            columnData = ret.data.sort(function (a,b) {
                return b.content-a.content;
            });
        }
    })
    //获取门店所有顾客-不分页
    quakooData.ajaxGetData(config.getUrl_user_getAllUser(),{sid:subid,userType:1},function (ret) {
        if(ret && ret.success){
            peopleData = ret.data;
        }
    })

    $("#yj-table").bootstrapTable('destroy');
    $("#yj-table").bootstrapTable({
        url: config.getUrl_inventoryOutBill_getCheckPager(),
        classes: "table",
        pagination: true,        //是否显示分页
        sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
        pageNumber: 1,                       //初始化加载第一页，默认第一页
        pageSize: 6,
        pageList: [6, 12, 18],
        sortable: false,
        sortOrder: "asc",
        showColumns: true,
        strictSearch: true,
        locale: "zh-CN",
        paginationHAlign: "center",
        clickToSelect: true,
        // paginationLoop:false,        //分页是否可以循环
        columns: [],
        queryParams:function (param) {
            param.subid = subid;
            param.token = quakooUser.getUserInfo().token;
            return param
        },
        onPreBody: function (data) {
            console.log(data)
            var html = '';
            var arr = [];
            for (var i = (this.pageNumber - 1) * this.pageSize; i < this.pageNumber * this.pageSize; i++) {
                if(this.data[i]){
                    arr.push(this.data[i])
                }
            }
            var html = template('dataTmp',{list:arr})
            $("#showUl").html(html);
        }
    });




    //新增入库弹窗
    function addRepertory() {
        var html = [];
        html.push('<div class="leftBox leftBoxTitle"> <div class="head"> <span class="title">添加商品</span> <div class="check_box"> <input type="checkbox" name="condition" id="out-ckType" > <label for="out-ckType">赠单入库</label>\n' +
            '        </div></div></div>');
        html.push('<div class="rightBox leftBoxTitle"> <div class="head"> <span class="title">入库单</span> <div class="selectBox" id="out-people">');
        html.push('<div class="select-box-header"><span class="text">入库人</span> <i class="iconfont icon-ico_arrow_down"></i></div><div class="optionBox"><ul class="optionUL">')
        for(var i=0;i<peopleData.length;i++){
            html.push('<li value="'+peopleData[i].id+'">'+peopleData[i].name+'</li>');
        }
        html.push('</ul></div></div><span class="person">入库人:</span></div></div>')
        layer.open({
            type: 1,
            shade: 0.01,
            title:  html.join(''),
            skin: 'content-view-tan content-view-enter-tan', //样式类名
            anim: 0,
            move:'.title',
            area: ['960px', '560px'],
            closeBtn: 0, //不显示关闭按钮
            resize: false,
            shadeClose: true, //开启遮罩关闭
            content: $('.content-view-enter'), //容器对象
            btn: ['关闭窗口','确认入库'],
            yes: function(index, layero){

            },
            btn2: function(index){
                alert(2)
            },
            success: function (layero, index) {
                // //底部按钮点击关闭弹窗
                var html = [];
                html.push('<div class="leftBox"><div class="foot">\n' +
                    '            <a class="layui-layer-btn0">关闭窗口</a>\n' +
                    '        </div></div>')
                html.push('<div class="rightBox"><div class="foot">\n' +
                    '            <a class="layui-layer-btn1">确认入库</a>\n' +
                    '            <div class="formBox">\n' +
                    '                <form class="layui-form">\n' +
                    '                    <div class="layui-form-item">\n' +
                    '                        <div class="layui-input-block">\n' +
                    '                            <input type="checkbox" value="打印出库单" name="like1[write]" lay-skin="primary"\n' +
                    '                                   lay-filter="print" title="打印出库单">\n' +
                    '                            <div class="layui-unselect layui-form-checkbox" lay-skin="primary"><span>打印出库单</span><i\n' +
                    '                                    class="layui-icon layui-icon-ok"></i></div>\n' +
                    '                        </div>\n' +
                    '                    </div>\n' +
                    '                </form>\n' +
                    '            </div>\n' +
                    '            <div class="formBox">\n' +
                    '                <form class="layui-form">\n' +
                    '                    <div class="layui-form-item">\n' +
                    '                        <div class="layui-input-block">\n' +
                    '                            <input type="checkbox" value="打印条码" name="like1[write]" lay-skin="primary"\n' +
                    '                                   lay-filter="print" title="打印条码">\n' +
                    '                            <div class="layui-unselect layui-form-checkbox" lay-skin="primary"><span>打印条码</span><i\n' +
                    '                                    class="layui-icon layui-icon-ok"></i></div>\n' +
                    '                        </div>\n' +
                    '                    </div>\n' +
                    '                </form>\n' +
                    '            </div>\n' +
                    '        </div></div>')
                $('.content-view-enter-tan .layui-layer-btn').html(html.join(''))
                addRepertorySuccess(index)

            }
        });
    }


    //查看不可修改入库单弹窗
    function checkRepertory() {
        layer.open({
            type: 1,
            shade: 0.01,
            title: '<span>入库单</span><span>入库人:耨耨耨</span>',
            skin: 'content-view-tan content-view-checkRepertory-tan', //样式类名
            anim: 0,
            area: ['380px', '560px'],
            closeBtn: 0, //不显示关闭按钮
            resize: false,
            shadeClose: true, //开启遮罩关闭
            content: $('.content-view-checkRepertory'), //容器对象
            btn: [''],
            yes: function (index) {

            },
            btn2: function (index) {

            },
            success: function (layero, index) {
                $('.content-view-checkRepertory .layui-layer-btn0').click(function () {
                    layer.close(index)
                })
            }
        });
    }


    //选择一级类目
    function chooseGoodsType(value){
        nowGoodData = {};
        $('.out-box>div').hide()
        $('.out-box>input').hide()
        $("#in-table").hide();
        cid = value;
        if(!allOutList[cid]){
            allOutList[cid] = {cid:cid,name:$('#category'+value).text(),data:[]}
        }
        $('#category'+value).addClass('active').siblings().removeClass('active');
    }
    var nowGoodData = {};
    var brandName = '';
    var seriesName = '';
    var providerName = '';
    function addRepertorySuccess(index) {
        var html = template('addTmp',{brandData:brandData,categoryData:categoryData,ballData:ballData,columnData:columnData,providerData:providerData})
        $('#addDom').html(html);
        $('.content-view-enter-tan .layui-layer-btn .layui-layer-btn0').click(function () {
            addOutList(0,index);
        });
        $('.content-view-enter-tan .layui-layer-btn .layui-layer-btn1').click(function () {
            addOutList(1,index)
        });
        $('#yj-category li').eq(0).click()
        selectTag($("#out-brand"), function (ret) {
            if(ret.value){
                bid = ret.value;
                brandName = ret.text;
                sid = -1;
                $('#out-series').html('');
                //获取品牌下的系列列表
                quakooData.ajaxGetData(config.getUrl_productSeries_getSubAllList(),{subid:quakooUser.getUserInfo().psid,bid:ret.value},function (ret1) {
                    if(ret1 && ret1.success){
                        var html2 = template('selectTagTmp',{title:'系列',list:ret1.data});
                        $('#out-series').html(html2).show();
                        selectTag($("#out-series"),function (series) {
                            sid = series.value;
                            seriesName = series.text;
                        })
                    }
                })
            }
        })
        selectTag($("#out-provider"), function (ret) {
            pid = ret.value;
            providerName = ret.text;
        })
        //商品类型
        selectTag($("#out-type"), function (ret) {
            type = ret.value;
        })
        //入库人
        selectTag($("#out-people"), function (ret) {
            peopleId = ret.value;
        })
        /*selectTag($("#out-ball"), function (ret) {
            nowBallId = ret.value;
            nowBallName = ret.text;
        })
        selectTag($("#out-column"), function (ret) {
            nowColumnId = ret.value;
            nowColumnName = ret.text;
        })*/
        outDate = new dateRange("#out-date",true);
        outDate.init()
        layui.use(['form'], function () {
            form = layui.form
            form.on('checkbox(print)', function (data) {
                console.log(data)
            });
        })
    }
    function getSpu() {
        if(!bid){
            layer.msg('请选择品牌')
            return
        }
        if(!pid){
            layer.msg('请选择供应商')
            return
        }
        quakooData.ajaxGetData(config.getUrl_inventoryOutBill_select(),{subid:subid,type:type,cid:cid,pid:pid,bid:bid,sid:sid},function (ret) {
            if(ret && ret.success){
                console.log(ret)
                if(ret.data){
                    nowGoodData = ret.data.skuList;
                    $('.out-box>div').hide()
                    $('.out-box>input').hide()
                    if($('#category'+cid).text()=='镜片'){
                        $("#in-table").show();
                        $("#in-table").bootstrapTable('destroy');
                        $("#in-table").bootstrapTable({
                            data: nowGoodData,                 //被加载的数据。
                            classes: "table",
                            sortable: false,
                            sortOrder: "asc",
                            showColumns: true,
                            strictSearch: true,
                            locale: "zh-CN",
                            paginationHAlign: "center",
                            clickToSelect: true,
                            columns: [
                                { field: 'code', title: '产品编码'},
                                { field: 'properties', title: '球' , formatter: function (value) {
                                        return value[15];
                                    }  },
                                { field: 'properties', title: '柱', formatter: function (value) {
                                        return value[16];
                                    }},
                                {field: '', title: '数量'  , formatter: function (value,row,index) {
                                        return '<input type="text" class="in-yj-input" data-index="'+index+'" placeholder="数量">';
                                    }
                                },
                            ]
                        });
                        // $('.jp-box').show();
                    }else if($('#category'+cid).text()=='镜架' || $('#category'+cid).text()=='太阳镜' ){
                        $('.jj-box').show();
                    }else if($('#category'+cid).text()=='隐形眼镜'){
                        $('.yxyj-box').show();
                    }else if($('#category'+cid).text()=='护理产品'){
                        $('.hlcp-box').show();
                    }else if($('#category'+cid).text()=='其它商品'){
                        $('.qtsp-box').show();
                    }


                }
            }else{
                layer.msg(ret.data)
            }
        })
    }
    //添加到本地入库单
    function addToList() {
        if(quakooUtils.isBlack(nowGoodData)){
            layer.msg('请查询商品')
            return
        }
        $('.in-yj-input').each(function (index,item) {
            if(quakooUtils.isNotBlack(item.value)){
                nowGoodData[item.getAttribute('data-index')].newNum = item.value;
            }
        })
        for(var i=0;i<nowGoodData.length;i++){
            nowGoodData[i].brandName = brandName;
            nowGoodData[i].seriesName = seriesName;
            nowGoodData[i].providerName = providerName;
            nowGoodData[i].xinghao = $('#out-xinghao').val();
            nowGoodData[i].sehao = $('#out-sehao').val();
            nowGoodData[i].num = $('#out-num').val();
            nowGoodData[i].shengchanpihao = $('#out-shengchanpihao').val();
            nowGoodData[i].outDate = outDate.getTime();
        }


        allOutList[cid].data = nowGoodData;
        var html = template('outListTmp',{list:allOutList})
        $("#outListDom").html(html)
    }
    //移除入库单中的商品
    function removeOutLi(i,j) {
        allOutList[i].data.splice(j,1);
        var html = template('outListTmp',{list:allOutList})
        $("#outListDom").html(html)
    }
    //确认入库
    function addOutList(status,index) {
        if(!peopleId){
            layer.msg('选择入库人');
            return
        }
        var params = {};
        params.subid = sid;
        params.inUid = peopleId;
        params.createUid = quakooUser.getUserInfo().id;
        if($('#out-ckType')[0].checked){
            ckType = 1;
        }else{
            ckType = 0;
        }
        params.status = status;
        params.itemsJson = [];
        console.log(allOutList)
        for(var i in allOutList){
            console.log(allOutList[i].data)
            if(allOutList[i].data){
                console.log(allOutList[i].data.length)
                for(var j=0;j<allOutList[i].data.length;j++){
                    var obj = {};
                    obj.spuid = allOutList[i].data[j].spuid;
                    obj.code = allOutList[i].data[j].code;
                    obj.retailPrice = allOutList[i].data[j].retailPrice;
                    obj.costPrice = allOutList[i].data[j].costPrice;
                    obj.integralPrice = allOutList[i].data[j].integralPrice;
                    obj.num = allOutList[i].data[j].newNum;
                    obj.properties = allOutList[i].data[j].properties;
                    params.itemsJson.push(obj)
                }
            }
        }
        console.log(params)
        params.itemsJson = JSON.stringify(params.itemsJson)
        console.log(params)
        quakooData.ajaxGetData(config.getUrl_inventoryOutBill_add(),params,function (ret) {
            console.log(ret)
        })
        // layer.close(index);

    }
</script>
</body>
</html>